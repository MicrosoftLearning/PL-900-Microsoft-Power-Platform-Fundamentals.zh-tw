---
lab:
  title: 實驗室 5：建立模型導向應用程式
  learning path: 'Learning Path: Demonstrate the capabilities of Microsoft Power Apps'
  module: 'Module 3: Build a model-driven app'
---
## 學習目標

在本練習中，學習者將使用 Copilot 在 Power Apps 中建立模型導向應用程式。 您將定義資料模型、修改表單和檢視，以及建立應用程式。

**成功完成本實驗室後，您將：**

-   建置模型導向應用程式。
-   修改應用程式中的表單和視圖，以最符合您的需求。
-   瀏覽模型導向應用程式。

### 案例

Contoso Consulting 是一家專門從事 IT 和 AI 諮詢服務的專業服務組織。 全年，他們都會為客戶提供許多不同的活動。 其中一些是貿易展覽風格的活動，他們有許多合作夥伴進來並提供有關新產品、市場趨勢和服務的詳細信息。 其他活動全年舉辦，是快速網路研討會，用於提供有關個別產品的詳細資訊。

Contoso 想要使用 Power Platform 來建置事件管理解決方案，以管理他們全年舉辦的不同活動。

在本練習中，您將建置模型導向應用程式來管理 Contoso 的事件。 模型導向應用程式將以現有的資料模型為基礎，並將包括事件、事件工作階段和工作階段註冊。

### 實驗室詳情：

在開始此練習之前，建議 已完成：

-   **實驗室 1 – 建立解決方案**
-   **實驗室 2 – 建立資料模型**

完成此練習的預計時間為 **20 至 30** 分鐘。

## 作業 1：建立資料模型以支援新的模型導向應用程式

Contoso 目前將連絡資訊儲存在其 Dataverse 執行個體中，因此他們想要使用 Dataverse 來追蹤課程和課程註冊。 您需要建立必要的資料表來支援應用程式，並根據該資料模型建置模型導向應用程式。

1.  如有必要，請開啟網頁瀏覽器並導覽至 [Power Apps](https://make.powerapps.com/) 製作者入口網站，然後使用您的 Microsoft 帳戶認證登入。
1.  使用左側的導覽，選取 **[解決方案]。**
1.  開啟您稍早建立的事件 **管理** 解決方案。
1.  在命令列上，選取**新增\>**** 應用程式****\>、模型導向應用程式**。****
1.  選取 建立** 區**段。
    -   **名稱**：`Contoso Event Management`
    -   **產品描述：**` Used to manage Events and Event Sessions`。
1.  選取**建立**按鈕。
1.  選取 +新增頁面**按鈕**，選取 **Dataverse 資料表。**
1.  選取下列資料表：
    -   連絡人​​
    -   事件
    -   事件工作階段
    -   工作階段註冊
1.  請確定 **已選取 [在導覽** 中顯示]。

    ![顯示「選取表格」對話方塊的螢幕擷取畫面。](media/bb46dc856d2939af9c55bdc0303b8a27.png)

1. 選取 [新增]**** 按鈕。

> **注意：** 有時，系統會在與設計工具合作時提示您登入。 選取 X 以取消登入畫面。

## 作業 2：編輯模型導向應用程式以符合您的需求

現在應用程序已經創建完畢，我們將對應用程序的呈現方式進行一些更改。 我們想要有兩個不同的群體;人物和事件。 我們想要在 [人員] 群組中擁有 [連絡人] 資料表，並在 [事件] 群組中擁有所有 [事件] 資料表。

1.  在畫面左側的導覽下****，選取**新增群組**。
1.  在應用程式的右側，展開 **屬性** 面板。
1.  將標題**從**「新增群組 **」變更**為 `People`。

    ![顯示更改群組名稱的屏幕截圖。 ](media/82b6d0cdc4fdbaf4a9eaf2d1f82e972f.png)

1.  選取 **[人員 **] **群組上的省略符號**。
1.  選擇 [ **新增群組**]。
1.  在 [屬性] **** 窗格中，將群組名稱從 [新增群組 **] 變更**為 `Events`。
1.  將滑鼠停留在左側的 [工作階段註冊] 檢視上 **，選取**省略符號**，然後選擇 **[向下**移動] 以將 [工作階段註冊 **] 移至 **[事件]** 群組。****
1.  將滑鼠游標停留在左側的 [事件工作階段] 檢視上 **，選取**省略符號**，然後選擇 **[向下**移動] 以將 **[事件工作階段**] 移至 [**事件]**** 群組。
1.  將滑鼠游標停留在左側的 [事件] 檢視**上**，選取**省略符號**，然後選擇 **[向下**移動] 以將 **[事件]** 移至 [事件] **群組**。

    您的應用程式應該類似於以下影像：

    ![顯示更新的 SiteMap 的螢幕擷取畫面](media/ff039cad105533933959854cec4ec95e.png)

## 作業 3：編輯模型導向應用程式中的不同表單和檢視

模型驅動程式應用程式會使用表單和檢視，在使用者介面 （UI） 中向使用者呈現資料。 我們將對這些項目進行一些更改。

1.  如有必要，請確定您的 **Contoso 事件管理** 應用程式已在設計工具中開啟。
1.  在畫面左側的 [人員] **群組下，將滑鼠停留在 [連絡人] 表單**上**，然後選取 [**** 編輯]。**

    如果系統提示您儲存變更，請選取 **[儲存並繼續]。**

1.  在左側的 [資料表資料行 **] 底下**，選取 [**新增資料表資料行**]。
1.  設定表格欄，如下所示：
    -   **顯示名稱 **`Contact Type`
    -   **資料類型：** 選擇
    -   **與全局選擇同步：** 否
1.  將第一個選擇的標籤**設定**為**揚聲器。**
1.  選取 **+ 新增選項，** 並將標籤設定為 **參與者。**
1.  選取 **[+ 新增選擇]**，並將標籤設定為 **[支援人員]。**

    ![[連絡人類型] 欄的螢幕擷取畫面。](media/b1982b779d91cf134b41b6f445b8f07c.png)

1.  選取 [儲存]**** 按鈕。
1.  使用滑鼠選取 新增連絡人** 文字**以選取表單標頭。 *（標題周圍應出現一個紫色矩形）*
1. 在 [表格欄] 底下的 **[搜尋 **] **欄位中，輸入 **[連絡人**]。**
1. 選取您剛建立的 [連絡人類型 **] **資料表資料行。
1. 聯絡人類型**現在**應該會出現在標題**中**。

    ![顯示表單上連絡人類型欄位的螢幕擷取畫面。](media/4debe7a09e460f79c1cb05a6824dad66.png)

1. 在表單**命令列**上，選取儲存並發佈**按鈕**。
1. 選取 **[返回] 箭頭** 按鈕以返回模型導向應用程式設計工具
1. 在左側的導覽下 **，將滑鼠停留在連絡人檢視**上**，然後選取編輯圖示****。** （如果系統提示儲存，請選取**保存並繼續。**
1. 選取 **[+ 檢視欄]。**
1. 搜尋 [連絡人類型 **] **資料行並將其新增至檢視。
1. 選取 **儲存並發佈** 按鈕。
1. 選取返回箭頭**按鈕**以返回模型導向應用程式設計工具。

    接下來，我們將對其餘表單進行必要的更改。

1.  在「導覽」**下**，選取「**事件檢視」**
    
    請注意，可能有 **EventDetails1** 資料行。 如果是這樣，我們將將其從視圖中刪除。 *（如果沒有，可以跳到 **作業 4：儲存並發佈**）*

1.  將滑鼠停留在「事件」**檢視**上，然後選取「編輯」**** 按鈕。

    如果提示儲存 **變更，** 請選取 **儲存並繼續**。

1.  在 [檢視] **上，選取 [EventDetails1 **] 旁的**箭號，然後從出現的功能表中選取 **[移除**]。**

    ![螢幕擷取畫面，顯示如何從檢視中移除額外的資料行。](media/f0f1484a4f3a679abc18cdb1cd5c04da.png)

1.  選取 **儲存並發佈** 按鈕。
1.  選取 **[上一頁] 箭號** 按鈕以返回應用程式設計工具。
1.  在 導覽 下 **，將滑鼠停留在 事件** **表單**上**，然後選取 **編輯。****

    如果系統提示您儲存變更，請選取 [ **儲存並繼續**]。

1.  選取 **[事件詳細資料1** ] 欄位，然後按 **鍵盤上的 Delete** 鍵。

    您的表單應類似於圖像：

    ![螢幕擷取畫面顯示移除額外欄之後更新的事件表單。 ](media/d9e8903c79b01e85e32c6ef5279a2ad5.png)

    如果它不完全匹配，只要圖片中的所有字段都在那裡就可以了。  

1.  選取 儲存並發佈** 按鈕**。
1.  選取 **[上一頁] 箭號** 按鈕以返回應用程式設計工具。

## 作業 4：儲存並發佈 （如果您的表單上沒有 EventDetail1 欄位，請繼續這裡。

1.  在應用程式的命令**列上**，選取儲存並發佈**按鈕**。

1.  選取 [返回] **** 按鈕以返回 [事件管理 **] **解決方案。
1.  選取 **返回解決方案** 箭號以返回主要 **Power Apps** 製作者入口網站。
1.  選取**返回箭**頭以返回 Power Apps** 主**畫面。

## 作業 5：測試您的新應用程式

現在您的模型導向應用程式已建立，我們將測試其功能。

首先，我們將添加幾個聯繫人。

1.  使用左側的導覽，選取 [應用程式]。
1.  將顯示的應用程式從「我的應用程式 **」變更**為 **「全部**」。
1.  將滑鼠停留在您剛才建立的 Contoso 事件管理應用程式上 **，然後選取 [播放 **] **圖示。**
1.  使用左側的導覽，選取 **[連絡人]。**
1.  在命令**列上**，選取 + 新增**按鈕**。
1.  在「新增聯絡人 **」** 畫面中，設定如下：
    -   **名字：** `Suzanne`
    -   **姓氏：** `Diaz`
    -   **職位名稱：** `Engineer`
1.  在表單標頭中，選取 [連絡人類型 **] **旁的向下箭頭。
1.  將聯絡人類型**設定**為**揚聲器。**

    ![螢幕擷取畫面顯示如何在表單上設定連絡人類型欄位。](media/0860116a9b7df096c14728212b9977b1.png)

1.  選取 [儲存] **** 按鈕以儲存連絡人，並將其保持開啟狀態。
1. 選取 [**+ 新增**] 按鈕。
1. 在「新增聯絡人 **」** 畫面中，設定如下：
    -   **名字：** 埃德加
    -   **姓氏：** 斯文森
    -   **職位名稱：** 建築師
    -   **電子郵件：** 輸入您的電子郵件地址（請務必新增 **您的** 電子郵件地址。
1. 在表單標頭中，選取 [連絡人類型 **] **旁的向下箭頭。
1. 將連絡人類型**設定**為**參與者**。
1. 選取 [儲存和關閉] **** 按鈕。

    接下來，我們將新增一個新事件。

1.  使用左側的導覽，選取 **[事件]。**
1.  在命令列上，選取 + 新增**按鈕**。
1.  在「新增事件 **」** 畫面中，設定如下：
    - **活動名稱：**`Spring conference`。
    - **活動日期：** 明天的日期。
    - **最大出席人數：** `500`
    - **活動詳情：**`Spring conference to showcase newest products and services from our supported vendors`。
    - **活動類型：** 會議
    - **位置**：`Seattle`
    - **需要註冊：** 是/對

    ![已完成的活動表單的屏幕截圖。 ](media/802f68c4c34c635eeff620a23d42acd8.png)

1.  選取 [儲存和關閉] **** 按鈕。

    接下來，我們將為活動新增一個工作階段。

1.  使用左側的導覽，選取 **[事件工作階段]。**
1.  選取 [**+ 新增**] 按鈕。
1.  設定 **事件工作階段** ，如下所示：
    - **會議名稱：** `Responsible AI`
    - **會議日期：** 明天的日期
    - **所需時間：** 1.5 小時
    - **會話描述：**`With all the new AI solutions, being responsible is important. We will discuss the challenges`。
    - **議長：** `Suzanne Diaz`
    - **事件：** `Spring Conference`

    ![已完成的活動會話表單的螢幕截圖。 ](media/6e509e4a29e6f253b5db3b4c9f82e42e.png)

1.  選取**儲存後關閉**按鈕。

    最後，我們將建立會 **話註冊**。

1.  使用左側的導覽，選取 **[工作階段註冊]。**
1.  在命令列上 **，選取 **+ 新增**。**
1.  按如下方式完成會話註冊：
    - **註冊名稱：**`E, Swenson Registration`。
    - **業主：** 保持原樣
    - **報名日期：** 今天日期
    - **特別說明：** `No Gluten`
    - **參與者：** `Edgar Swenson`
    - **活動環節：** `Responsible AI`

    ![已填妥的會議註冊表的螢幕截圖。  ](media/Session-registration-form.png)

1.  選取 [儲存後關閉]**** 按鈕。
