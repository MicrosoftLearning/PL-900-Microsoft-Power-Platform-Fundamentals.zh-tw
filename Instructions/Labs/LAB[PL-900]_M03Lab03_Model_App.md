---
lab:
    title: '實驗室 4：如何建立模型導向應用程式'
    module: '單元 3：Power Apps 入門'
---

# 單元 3：Power Apps 入門
## 實驗室 3：如何建立模型導向應用程式

### 重要通知 (自 2020 年 11 月起生效)：
Common Data Service 已更名為 Microsoft Dataverse。Microsoft Dataverse 中採用的部分詞彙已經更新。例如實體 [現在稱為 **資料表**]、欄位 [現在稱為 **資料行**] 及記錄 [現在稱為 **資料列**] 的部分參考資料可能尚未更新。當您在進行實驗室作業時，請記住這一點。我們預期很快就會完全更新提供的內容。

如需詳細資訊及受影響字詞的完整清單，請造訪[什麼是 Microsoft Dataverse？](https://docs.microsoft.com/zh-tw/powerapps/maker/common-data-service/data-platform-intro#terminology-updates)

# 案例

Bellows College 是一個教育組織，校園內有多棟大樓。校園訪客目前記錄在紙本日誌中。此資訊並未以一致的方式擷取，而且也無法收集和分析整個校園造訪情形的相關資料。 

校園行政單位想要更新其訪客登記系統，讓保全人員控管各棟大樓的出入狀況，且所有造訪情形都必須由大樓負責人預先登記和記錄。

在整個課程中，您將建立應用程式並執行自動化功能，以便 Bellows College 的行政和保全人員能夠管理及控管校內大樓的出入狀況。 

在此實驗室中，您將建立 Power Apps 模型導向驅動程式，可讓後端辦公室校園教職員管理整個校園中的造訪情形記錄。

# 高階實驗室步驟

在建立模型導向應用程式的過程中，您將完成下列工作：

-   建立名稱為 [校園管理] 的新模型導向應用程式

-   編輯應用程式導覽以參考必要的資料表

-   自訂應用程式必要資料表的表單和檢視

我們將使用下列元件：

- **檢視**：「檢視」可讓使用者在表單資料表中顯示現有資料。

- **表單**：使用者可於此處建立/更新資料表中的新資料列。

兩者均會整合至模型導向應用程式，以提供更優質的使用者體驗。

## 先決條件

* 完成**單元 0 實驗室 0：驗證實驗室環境**
* 完成**單元 2 實驗室 1：Microsoft Dataverse 簡介**

## 開始前要考慮的事項

-   我們應該進行哪些變更以提升使用者體驗？

-   根據我們已建立的資料模型，應該在模型導向應用程式中包含哪些項目？
    
-   在模型導向應用程式的網站地圖上，我們可以完成哪些自訂項目？


# 練習 1：自訂檢視和表單

**目標：** 在此練習中，您將針對要在模型導向應用程式中使用的自訂建立資料表自訂檢視和表單。

## 工作 1：編輯「造訪情形」表單

1.  如果尚未登入，請登入 <https://make.powerapps.com>。

2.  選取您的**環境**。

3.  選取 **[解決方案]**。

4.  按一下以開啟**校園管理**解決方案。

5.  按一下以開啟 **[造訪情形]** 實體。

6.  選取 **[表單]** 索引標籤，然後按一下以開啟 **[主要]** 表單類型。 

    > 依預設，表單具有兩個欄位：[名稱] (主要欄位) 和 [擁有者]。
    
7.  選取 **[+ 表單欄位]**，然後將資料行拖曳至表單或按一下資料行名稱，即可在 **[擁有者]** 欄位下方新增下列欄位：

    * **大樓**
    * **訪客**
    * **預定開始時間**
    * **預定結束時間**
    * **實際開始時間**
    * **實際結束時間** 
    
8.  拖曳 **[代碼]** 資料行，然後將其拖放至表單標頭。 

    > 標頭為表單的右上方區域。您可能需要最小化畫面右側的 [屬性] 面板，才能看到表單上的欄位。

9.  在仍選取 **[代碼]** 欄位時，在 [屬性] 面板中選取 **[唯讀]** 的核取方塊。

10.  選取 **[擁有者]** 欄位。在 [屬性] 面板中，將 **[欄位標籤]** 變更為 **[負責人]**

11.  按一下右上方的 **[儲存]**，然後等待儲存完成。

12.  按一下右上方的 **[發佈]**，然後等待發佈完成。

13.  按一下畫面左上方的 **[上一步]** 箭頭。您現在應該會回到
     [造訪情形] 實體的 [表單] 索引標籤。

## 工作 2：編輯「造訪情形」檢視

在此工作中，我們將修改預設的 [現行造訪情形] 檢視，並為今天的造訪情形建立新的檢視。

1.  選取 **[檢視]** 索引標籤，然後按一下以開啟 **[現行造訪情形]** 檢視。

2.  按一下或拖放下列欄位，將欄位新增至檢視：

    *  **代碼**
    *  **訪客**
    *  **大樓**
    *  **預定開始時間** 
    *  **預定結束時間**
    
3.  按一下 **[建立時間]** 資料行，然後選取 **[移除]**。即可立即從檢視中移除 **[建立時間]** 欄位。

4.  按一下 **[名稱]** 資料行，然後選取 **[移除]**。即可立即從檢視中移除 **[名稱]** 欄位。

5.  在右側的 [屬性] 面板中，按一下 **[排序方式...]**，然後選取 **[預定開始時間]**。再按一下 **[預定開始時間]** 可將順序變更為遞減。

6.  調整個別資料行的寬度以符合資料大小。

7.  按一下 **[儲存]**，然後等待變更儲存完畢。

8.  按一下 **[發佈]**，然後等待發佈完成。

接下來，我們將複製檢視為今天的造訪情形建立新的檢視。

9.  在 [屬性] 面板中按下 **[編輯篩選條件]** 連結。

10.  按一下 **[新增]**，然後選取 **[新增資料列]**。

11.  選取 **[預定開始時間]** 做為欄位，然後選取 **[今天]** 做為下拉式清單中的條件。 

12.  按一下 **[狀態]** 資料列上的 **[...]**，然後按一下 **[刪除]**。 

13.  按下 **[確定]** 以儲存條件。檢視現謝謝你的圖在已篩選為僅顯示 [預定開始時間] 的日期為今天的記錄。

14.  將 **[實際開始時間]** 和 **[實際結束時間]** 欄位新增至檢視。 

> **注意：** 由於我們不再依據檢視狀態進行篩選，因此將會取得今天的所有造訪情形，包括已完成的項目。這兩個欄位將有助於區分已完成的造訪情形和進行中的造訪情形。

15.  按一下 [儲存] 按鈕旁邊的 **[下拉式箭頭]** (請小心不要按下按鈕本身)，然後選取 **[另存新檔]**。

16.  將名稱變更為 **[今天的造訪情形]**，然後按下 **[儲存]**。

17.  按一下 **[發佈]**，然後等待發佈完成。

# 練習 2：建立模型導向應用程式

**目標：** 在此練習中，您將建立模型導向應用程式、自訂網站地圖，以及測試應用程式。

> 在建構應用程式時，您會看到尚未處理的多個欄位，尤其是在網站地圖步驟中。為完成各個實驗室，我們採取了一些捷徑。在真正的實作中，您應該為這些項目指定邏輯名稱。

## 工作 1：建立應用程式

1.  如果您尚未在 [校園管理] 解決方案中，請將其開啟。

    -   登入 <https://make.powerapps.com>

    -   在您的環境中時，按一下以開啟您的 **[校園管理]**
        解決方案。
    
2.  建立模型導向應用程式

    -   按一下 **[新增]** 並選取 **[應用程式]**，然後選取 **[模型導向應用程式]**。此動作會開啟新的索引標籤。
    
    -   輸入 **[您的姓氏] 校園管理**做為名稱。

    -   選取 **[使用現有的解決方案建立應用程式]** 核取方塊

    -   選取 **[下一步]**

    -   選取 **[校園管理]** 解決方案
    
    -   按一下 **[完成]**
    
3.  按一下 **[網站地圖]** 旁邊的鉛筆圖示。

4.  編輯預設標題

    -   選取 **[新的區域]**。

    -   在右側的屬性窗格中，將新區域的標題變更為**校園**。

    -   選取 **[新的群組]**。

    -   在右側的屬性窗格中，將新群組的標題變更為**安全性**。
    
5.  將「連絡人」資料表新增至網站地圖

    -   選取 **[新的子區域]**。

    -   在 **[屬性]** 窗格中，從 **[類型]** 下拉式清單中
        選取 **[實體]**。

    -   從 **[實體]** 下拉式清單中搜尋 **[連絡人]** 資料表。
    
6.  將「造訪情形」資料表新增至網站地圖

    -   選取 **[安全性]** 群組，然後按一下 **[新增]**。

    -   選取 **[子區域]**。

    -   前往 **[屬性]** 窗格。

    -   從 **[類型]** 下拉式清單中選取 **[實體]**，然後從
        **[實體]** 下拉式清單中搜尋 **[造訪情形]** 資料表。
    
7.  將「大樓」資料表新增至網站地圖

    -   選取 **[校園]** 區域，然後按一下 **[新增]**。
    
    -   選取 **[群組]**。
    
    -   在 **[屬性]** 窗格中，輸入**設定**做為 **標題**。
    
    -   在仍選取 **[設定]** 群組時，按一下 **[新增]**。
    
    -   選取 **[子區域]**。
    
    -   前往 **[屬性]** 窗格。
    
    -   從 **[類型]** 下拉式清單中選取 **[實體]**，然後從 **[實體]** 下拉式清單中搜尋 **[大樓]** 資料表。

8.  按一下 **[儲存]**。此動作會在儲存變更時顯示載入畫面。

9.  按一下 **[發佈]** 以發佈網站地圖，然後等待發佈完成。

10.  按一下 **[儲存後關閉]** 以關閉網站地圖編輯器。 

    > 您會看到新增至網站地圖的實體資產現在已位於應用程式中。
     
11.  按一下應用程式設計工具的 **[儲存]**。

12.  按一下 **[驗證]** 以驗證在應用程式中所做的變更。 

>  此動作會顯示一些警告，但我們可以直接忽略，因為我們尚未參考實體的特定「檢視」和「表單」，且使用者將可存取 **[造訪情形]** 和 **[大樓]** 實體的所有「檢視」和「表單」。
     
13. 按一下 **[發佈]**

14.  按一下 **[儲存後關閉]** 以關閉應用程式設計工具。

15.  按一下 **[完成]**。

16.  選取 **[解決方案]**，然後選取 **[發佈所有自訂項目]**。

17.  選取 **[應用程式]**，系統現在應該會列出您的應用程式。

## 工作 2：測試應用程式

1.  啟動應用程式

    -   選取 **[應用程式]**，然後按一下您的 **[校園管理]** 應用程式。(如果您一開始沒有看到您的應用程式，則可能需要重新整理瀏覽器。)

    -   應用程式應在新視窗中開啟。
    
2.  建立新的「連絡人」

    -   應用程式應開啟至 **[現行連絡人]** 檢視

    -   從頂端功能表中按一下 **[新增]**。

    -   將 **[名字]** 輸入為 `John`，**[姓氏]** 則為 `Doe`。

    -   提供您的個人電子郵件做為 **[電子郵件]**。 此項目將用於之後的實驗室中。 
    
    -   按一下 **[儲存後關閉]**。

    -   您現在應該會在 **[現行連絡人]** 檢視中看到已建立的連絡人。
    
3.  建立新的「大樓」

    -   從地圖網站中選取 **[大樓]**。

    -   按一下 **[新增]**。

    -   將 **[名稱]** 輸入為 `Microsoft Building`
        
    -   按一下 **[儲存後關閉]**。此動作會在 [現行大樓] 檢視中
        顯示新建立的記錄。
    
4.  建立新的「造訪情形」

    -   從網站地圖中選取 **[造訪情形]**。
    
    -   按一下 **[新增]**。
    
    -   依照下列內容輸入欄位 
    
        -   **名稱**：`New test visit`
        -   **大樓**：選取 [Microsoft Building]
        -   **訪客**：選取 [John Doe]
        -   **預定開始時間**：選取明天的日期和下午 2:00 做為開始時間
        -   **預定結束時間**：選取明天的日期和下午 3:30 做為結束時間
        
    -   按一下 **[儲存後關閉]**。此動作會建立 [造訪情形]，您應該可以在 [現行造訪情形] 檢視中
        看到此項目。
        
    -   將檢視變更為 **[今天的造訪情形]**。您應該不會再於此檢視中看到新的造訪情形，因為其預定時間為明天。
    
5. 您可以新增其他測試記錄。

   您正在執行的應用程式看起來應近似於下圖：

![模型導向應用程式範例](media/3-model-app.png)

# 挑戰

* 選取 [造訪情形] 和 [大樓] 的特定檢視和表單
* 保全人員通常都在單一大樓中工作。您要如何為他們提供簡易的方式，以便僅顯示選定大樓的造訪情形？
* 限制對特定實體的存取，例如：[大樓] 應對系統管理員以外的所有教職員成員設為唯讀
* 您會考慮在應用程式中新增哪些儀表板？
