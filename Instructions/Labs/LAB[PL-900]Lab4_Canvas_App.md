---
lab:
  title: 實驗室 4：建立畫布應用程式
  learning path: 'Learning Path: Demonstrate the capabilities of Microsoft Power Apps'
  module: 'Module 2: Build a canvas app'
---
## 學習目標

在本練習中，您將使用 Copilot 建立畫布應用程式，員工可用來申請和管理休假和設備結帳要求。 建立應用程式後，您將使用 Copilot 和 Power Apps 設計工具來修改應用程式。

成功完成本實驗室後，您將：

- 使用 Copilot 協助您建立資料模型來支援您的應用程式。
- 修改畫布應用程式。

### 案例

Contoso Consulting 是一家專門從事 IT 和 AI 諮詢服務的專業服務組織。 他們希望創建一個休假應用程序，員工可以使用該申請來請求休假。

### 實驗室詳細資料

在開始本練習之前，您必須完成下列實驗室：

- **實驗室 2 – 建立資料模型**

> **重要事項** 此實驗室使用 AI 來建置元件。 由於 AI 結果可能會有所不同，因此請務必注意，您的結果可能與實驗室中定義的結果不同（但相似）。 實驗室中概述的基本概念將是相同的，無論創建了什麼或命名是什麼。 如果表格和欄不完全相符，您可能需要調整為為您建立的內容。

完成此練習的預計時間為 **60 至 75** 分鐘。

## 工作 1：登入 Power Apps 並探索介面

1.  開啟網頁瀏覽器並導覽至 [Power Apps](https://make.powerapps.com/) 製作者入口網站。
1.  使用左側的導覽，選取 **[建立]。**
1.  在建立您的應用程式**下**，選擇 從 Copilot** 開始。**
1.  在描述您希望副手建立**的資料表畫面**中，輸入：*` I want to store time off requests sent by employees. The table should identify the start and end times of the request.`*
1.  選取 [表格選項 **] **按鈕。 從出現的功能表中，選取 **One Table**。

    ![Copilot 入門螢幕截圖](media/60a2ec72988f48c91df7c370532cb331.png)

1.  選取 產生** 按鈕**。

    Copilot 應該已建立請 **假申請** 資料表。 接下來，我們將在表格中新增更多列。

    **注意**：如有必要，請添加表名稱以提示。

1.  在 [Copilot **] 窗格中**，輸入：*`Add a choice column called Time Off Reason.`*
1.  在 [Copilot **] 窗格中**，個別新增下列提示。
    - *`Add a choice column named Time off Type.`*
    - *`Add a Date column called Submission Date.`*
    - *`Add a choice column to the Time Off request table called Approval Status.`*
    - *`Add a multi-line text column called Request Details.`*

    您的休假表應類似於以下圖像：

    ![已完成的請假申請表的螢幕擷取畫面 ](media/2ac256daafe1853e5367852467690c76.png)

    接下來，我們將把使用者資料表新增至資料模型，以便我們可以將休假請求與特定使用者建立關聯。

1.  在命令列上 **，選取 **+ 現有資料表**。**
1.  從 **「建議」** 切換為 **「** 所有表格」。
1.  在 搜尋** 欄位**中，輸入**使用者**。
1.  選取「使用者 **」** 表格，然後按一下「新增選取項目 **」** 按鈕。
1.  在命令列**上**，選取**建立關聯性。**
1.  設定關係，如下所示：

    -   **一：** 用戶
    -   **許多：** 請假請求
    -   **顯示名稱 **`Requesting Employee`
  
1.  選取**完成**。

    您完成的資料模型應類似於影像：

    ![已完成資料模型的螢幕擷取畫面 ](media/daa74d51e2ceada8e1e8b004cae9942a.png)

1.  選取 [儲存並開啟應用程式 **] **按鈕。

> [!NOTE]
> 建立新應用程式可能需要幾分鐘的時間。

## 作業 2：個人化您的新應用程式

現在您的新應用程序已經創建完畢，我們將對其進行一些修改以最好地滿足我們的需求。 我們將首先對歡迎屏幕進行一些修改。

1.  開啟新應用程式後，選取「請假申請」**文字上方的「影像 **」**** 預留位置。
1.  從出現的功能表中，選取 **編輯****\>上傳。**
1.  選擇班級檔案資料夾中的 [請假 **] **影像，然後選取 [**開啟**]。
1.  接下來，選擇 **使用者** 上方**的圖像**佔位符。
1.  從出現的功能表中，選取 **編輯****\>上傳。**
1.  選擇 **類別檔案資料夾中的員工** 影像，然後選取 [ **開啟**]。

    接下來，我們將調整圖像的大小，使其更易於使用閱讀。 此外，我們將調整每個項目顯示的文字。

1.  在命令列**上**，選取屬性**按鈕**。 （*位於編輯按鈕的右側。*
1.  選取 **您稍早新增的請假** 影像。
1.  在「屬性」**** 面板中，設定影像，如下所示：
    
    -   **影像位置：** 填滿
    -   **寬度：** 300
    -   **高度：** 300
      
1.  重複先前的步驟，將員工**影像的**高度**和**寬度**設定為****300** x **300**。
1.  選取「請假申請」**下方**的文字。
1.  在「屬性」**** 面板中，選取「文字」**** 欄位，並將文字變更為：*`Create, View, and Manage you time off requests.`*
1.  選取**標題**中的**歡迎畫面**文字。
1.  在右側的 [屬性] **** 窗格中，選取 [標誌] **** 欄位。
1.  從出現的功能表中，選取 **上傳。**
1. 從類別檔案中選取 **Contoso 標誌** ，然後選取 **[開啟**]。
1. 在「屬性」**** 面板的「樣式和主題」**** 群組下，選取「填滿顏色」**** 圖示。
1. 選取 [自訂] **** 索引標籤
1. 將十六進制**顏色**變更為：`101E2B`
1. 請確定您仍選取 [標頭]**，並將 [標題]** **變更為 。`Contoso Employee Hub`**
1. 在命令列上 **，選取儲存**按鈕**以儲存**應用程式。
1. 在 [儲存] **** 畫面中，將 [名稱 **] **設定為 `Contoso Employee Hub`，然後選取 [**儲存]。**

    您的應用程式將類似於圖像。

    ![Canvas 應用程序歡迎屏幕的屏幕截圖。](media/533c80cc861941b6a353b56bfc0dbc0f.png)

## 作業 3：將新畫面新增至您的應用程式。

當您構建應用程序時，您的一位經理會聯繫您，並想知道員工是否也可以使用此應用程序來檢查設備。 Contoso 已經將設備簽出資訊儲存在 Dataverse 中，因此只需在應用程式中提供資訊即可。

1.  當您的應用程式仍開啟時，展開 **Copilot** 窗格 （如有必要）。 在 Copilot 中，輸入下列內容： *`Add a new screen called Equipment Checkout.`*
1.  請選取**傳送**。
1.  選取 [ **保留]** 按鈕以接受畫面。
1.  一個名為「設備結帳 **」的新**畫面會新增至您的應用程式。
1.  在「設備出庫」**畫面上，按一下「**使用版面配置**」，然後選擇「側邊欄 **」** 版面**配置。
1.  展開不同的容器，直到 SideBarContainer** 可見為止**。

    ![樹狀視圖截圖 ](media/cde6257402b7a8786e679ab64ee0f882.png)

1.  以滑鼠右鍵按一下 **SidebarContainer** ，並將名稱重新命名為 **EquipContainer1**。
1.  選取 EquipContainer1 容器後 **，按一下 **開啟插入功能表**** 按鈕。
1.  在 [搜尋] **視窗中，輸入 **[圖庫**]，然後選取 **[垂直圖庫**]。**
1.  當系統詢問您時，請您在出現的「搜尋 **」** 欄位中提供資料來源，輸入 **「設備」**，然後選取「設備」**** 表格。
1. 在畫面左側的 [樹狀檢視] 中 **，選取**您剛才新增的 Gallery1** 控制**項。
1. 以滑鼠右鍵按一下 [圖庫] 名稱，選擇 **[重新命名**]，然後重新命名為 `Equipment List`。
1. 將滑鼠停留在 [設備清單 **] **圖庫上，在圖庫上方顯示的工具列上，選取 **[版面配置]。**
1. 選取 [標題和副標題版面配置 **] **選項。
1. 選取 [設備清單] **** 資源庫後，在 [屬性] **** 窗格中，設定如下：

    -   **Width**: `360`
    -   **彈性高度：** 開啟
    -   **最低高度：** `287`

    接下來，我們將在 EquipmentContiner1 容器中**新增一個額外的容器，以儲存搜尋控制項，我們將用來篩選 [設備清單]** 資源庫的內容**。**

1.  在樹狀結構**檢視中**，選取 **EquipContainer1**。
1.  將滑鼠停留在容器上，然後選取 **Copilot** 圖示。
1.  輸入下列文字： *`Insert a Horizontal container.`*

    ![將圖庫插入容器的螢幕擷取畫面。](media/b9b784ea5625469c8785650b977f32d1.png)

1.  選取 [保留] **** 按鈕。
1.  新容器將新增至 EquipContainer1** 容器的**底部。
1.  在「樹狀檢視 **」** 中，按一下、按住並拖曳新容器，並將其放置在「設備清單 **」** 圖庫上方。
1.  將容器重新命名為 `EquipSearchContainer`。
1.  選取 EquipSearchContainer** 後**，在 [屬性] **** 窗格中，設定如下：
    
    -   **最小寬度：** `0`
    -   **靈活高度：** 關閉
    -   **Height**: `44`
    
1.  選取 EquipSearchContainer** 後**，選取 開啟**插入功能表** 按鈕。
1. 在搜尋欄位**中，輸入**文字**，然後選取**文字輸入**。**
1. 將「文字輸入 **」** 欄位重新命名為 `EquipSearchInput`。
1. 選取 EquipSearchInput** 後**，在 [屬性] **** 窗格中，設定如下：

    -   **預設值：** 空白 （無）
    -   **提示文字：** 搜尋
    -   **字體：** Open Sans
    -   **字體大小：** 14
    -   **內邊距** （下列值可能已經存在。
        -   **頂部：** 5
        -   **底部：** 5
        -   **左：** 12
        -   **右：** 5
    -   **身高：** 44
    -   **彈性寬度：** 開啟
    -   **最小寬度：** 0

        ![搜尋輸入屬性的螢幕擷取畫面。](media/b0e092b4795edf58dad1153209639051.png)

1. 在「樹狀檢視 **」中**，選取 **EquipSearchContainer。**
1. 將滑鼠停留在容器上，選取 **Copilot** 圖示，然後輸入 *`Add a Search Icon.`*
1. 選取 [**保留]。**

    > **注意：** 如果 Copilot 碰巧新增了錯誤的圖標，請將其刪除並手動插入放大鏡。

1. 選取 搜尋 圖示**** 後，在 屬性** 窗**格中，設定控制項，如下所示：

    -   **填補**
        -   **頂部：** 10
        -   **波頓：** 10
        -   **左：** 10
        -   **右：** 10
    -   **身高：** 44
    -   **寬度：** 44

    ![搜尋圖示屬性的螢幕擷取畫面](media/cb3305731a09bca0bbf166d55d9822a4.png)

1. 使用左側的樹 **狀結構檢視** ，選取 **EquipSearchContainer。**

    最後，我們將配置 **設備清單** 庫，以根據在搜尋控制欄位中輸入的文字填充其資料。

1.  選取 **我們先前建立的 [設備清單]** 圖庫。
1.  在 [項目] **** 屬性中，輸入下列公式：`Search([@'Equipments'], EquipSearchInput.Text, 'Equipment Name',Category)`

    ![項目 PowerFx 公式的屏幕截圖。](media/powerfx-formula.png)

1. 在命令**列上**，選取 [儲存] **** 按鈕以儲存您的應用程式。

> **重要事項：** 如果您將公式複製並貼到編輯列中，則「設備」和「設備名稱」的「」可能不正確。 如果您收到公式錯誤，請嘗試刪除並重新輸入它們。

## 作業 4： 建置儲存器以顯示記錄作業。

當使用者在「設備」清單中選取記錄時，我們想要在另一個容器中開啟該記錄，以允許他們編輯選取的記錄。

1.  選取 **MainContainer** 並將其重新命名為 `DetailsContainer`。
1.  在 DetailsContainer** 上**，選取 [插入] **** 按鈕。
1.  在 [搜尋] **欄位中，輸入 **[容器]**，然後選擇 **[垂直容器**]。**
1.  按一下滑鼠右鍵， **然後將容器重新命名** 為 `RecordDetails`。
1.  在 RecordDetails** 容器上**，選取 [插入] **** 按鈕。
1.  在 [ 插入 ] **** 功能表上，選取 **[ 編輯表單**]。
1.  在選取資料來源畫面中，選取**設備。** *（資料最多可能需要 30 秒才能填入。*
1.  以滑鼠右鍵按一下您剛才新增的表單，然後 **將其重新命名** 為 `EquipmentForm`。
1.  在 [屬性] **** 窗格中，選取 [進階 **] **索引標籤，並將 [項目]** **屬性設定為： `'Equipment List'.Selected` *（這會使用目前選取的記錄填入表單。*
1. 選取 **顯示** 索引標籤，然後設定表單，如下所示：

    -   **欄數：** 2
    -   **預設模式：** 編輯

    現在我們將新增另一個容器，用於控制表單上的操作。

1.  請確定您已 **選取 DetailsContainer** 。
1.  選取 **出現的 Copilot** 圖示。 輸入下列項目： *`Insert a horizontal container.`*
1.  選取 [**保留]。**
1.  以滑鼠右鍵按一下容器，然後 **將其重新命名** 為 `SelectedRecord1`
1.  使用樹狀結構**檢視，將 **SelectedRecord1** 容器移至 **RecordDetails** 容器上方**。
1.  設定 **SelectedRecord1** 容器，如下所示：
    
    -   **最小寬度：** 250
    -   **靈活高度：** 關閉
    -   **身高：** 50
    
1.  選取 SelectedRecord1 容器後 **，選取 **[插入]**** 按鈕。
1.  選取 [ **文字標籤]。**
1.  將標籤重新命名為 `SelectedRecordTitle`。
1. 設定 SelectedRecordTitle **，** 如下所示：

    1.  **填補**
        1.  **頂部：** 5
        2.  **底部：** 5
        3.  **左：** 30
        4.  **右：** 5
    2.  **彈性寬度：** 開啟
    3.  **最小寬度：** 150
    4.  **身高：** 40
       
1. 選取 **SecondRecord1** 容器，選取 [插入] **** 按鈕。
1. 在 搜尋** 欄位**中，輸入 **儲存**，然後選取 **儲存** 圖示。
1. 設定 儲存** 按鈕，** 如下所示：

    -   **身高：** 40
    -   **寬度：** 40
      
1. 選取 **OnSelect** 屬性，然後輸入下列公式： `SubmitForm(EquipmentForm)`。

    ![OnSelect PowerFx 公式的螢幕截圖。](media/e5b22c91a437e6918269d65e2616afc8.png)

## 作業 5：修改頁面上的標頭

建立此畫面的最後一個步驟是用資料填入讀取器容器。

1.  選取 **應用程式頂端的 HeaderContainer** 。
1.  選取 [插入] **** 按鈕。
1.  選取**文字標籤**。
1.  設定 **文字標籤** 控制項，如下所示：
   
    -   **Text**: `Equipment Checkout`
    -   **字體：** Open Sans
    -   **字體大小：** 16
    -   **字體粗細：** 半粗體
    -  **填補**
        -   **頂部：** 16
        -   **底部：** 16
        -   **左：** 16
        -   **右：** 16
    -   **身高：** 40
    -   **彈性寬度：** 開啟

        ![文字標籤屬性的螢幕擷取畫面。](media/088cafeec651b099fa49ac1f151cd228.png)

1.  選取 HeaderContainer，選擇 [插入]**，然後選取 [首頁圖示****]。******
1.  將主頁按鈕的 OnSelect** 屬性設定**為：`Back()`

    ![[返回導覽] 命令的螢幕擷取畫面。](media/38d0e5367ee41da58ac9902f8056b1af.png)

## 作業 6：完成設定「歡迎使用」畫面

經過審查，我們決定不需要在此應用程式中建立使用者，因此我們將更改歡迎畫面以允許您存取設備結帳。

1.  使用樹狀結構檢視 **，** 選取**歡迎畫面**。
1.  選取使用者上方**** 的**影像**。
1.  從出現的功能表中，選取 **[編輯]**，然後選擇 **[上傳]。**
1.  在您的學生資料夾中找到「設備」**** 影像，然後選擇 **「開啟**」。
1.  將影像的 OnSelect** 屬性設定**為：`Navigate('Equipment Checkout')`
1.  選取 使用者 文字 **，並將 文字** 屬性設定**為 `Equipment`。**
1.  選取「設備」下方的「**文字」**，並將「文字」**** 性質變更為：`Check out equipment and edit reservations`。****

    ![電腦人工智慧生成內容的螢幕截圖可能不正確。](media/561d1e8cd023541761b6523138c2fde8.png)

1. 選取 [儲存] **** 按鈕以儲存您的應用程式。

## 作業 7：測試您的應用程式

1.  在命令列**上**，選取 [播放 **] **按鈕。
1.  選取 [設備] **** 影像。
1.  在 搜尋** 欄位**中，輸入 **Electronics**。 （*注意列表如何過濾*）
1.  選取 [筆記型電腦] **** 記錄。
1.  將類別**變更**為**家具**。
1.  選取 [儲存]**** 按鈕。
1.  請注意筆記本電腦**的**類別如何更改為**家具**。
1.  選取 [首頁 **] **按鈕。
1.  選擇 **紫色 X** 以離開 **預覽** 模式。

## 作業 8：儲存並發佈應用程式

**目標：** 儲存並發布應用程式，使其可跨網頁瀏覽器、行動裝置或嵌入式平台（如 SharePoint 或 Teams）存取。

1.  在 Power Apps Studio 中，選取儲存**按鈕**。
1.  選取 [發佈] 按鈕。
1.  選擇 Publish this version （ **發佈此版本）。**
