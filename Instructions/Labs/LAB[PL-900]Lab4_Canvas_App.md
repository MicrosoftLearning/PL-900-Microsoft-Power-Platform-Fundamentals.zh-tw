---
lab:
  title: 實驗室4：建立畫布應用程式
  learning path: 'Learning Path: Demonstrate the capabilities of Microsoft Power Apps'
  module: 'Module 2: Build a canvas app'
---
## 學習目標

在此練習中，您將使用 Copilot 建立畫布應用程式，讓員工可用來要求和管理休息時間及設備結帳要求。 建立應用程式之後，您將使用 Copilot 和 Power Apps 設計工具來修改應用程式。

完成此實驗室之後，您將：

- 使用 Copilot 協助您建立數據模型以支援您的應用程式。
- 修改畫布應用程式。

### 案例

Contoso 諮詢是一個專業服務組織，專門從事 IT 和 AI 諮詢服務。 他們想要建立員工可用來要求休息時間的休息應用程式。

### 實驗室詳細數據

開始本練習之前，您必須先完成下列實驗室：

- **實驗室 1 – 使用計劃設計工具建立解決方案**

> [!IMPORTANT]
> 此實驗室會使用 AI 來建置元件。 由於 AI 結果可能會有所不同，因此請務必注意，您的結果可能會與實驗室中定義的結果不同（但類似）。 實驗室中概述的基本概念將會是相同的，無論所建立的專案或所命名的內容為何。 如果資料表和數據行不完全相符，您可能需要調整為您建立的專案。*

**您可以在這裡[找到此實驗室](https://myriumtechsolutions-my.sharepoint.com/:f:/p/derik_bormann/EnSzkatV6HlPvJBFUM8G6xkBd9flg9PfhBDKFW-yDZfPuw?e=v40ti4)的影像：**

完成此練習 **的估計時間為 45 到 60** 分鐘。

## 工作 1：登入 Power Apps 並探索介面

1.  開啟網頁瀏覽器並流覽至 [Power Apps](https://make.powerapps.com/) 製作者入口網站。
2.  使用左側導覽，選取 [ **建立**]。
3.  在 [建立您的應用程式 **] 下**，選擇 [**開始使用 Copilot**]。
4.  在 [ **描述您要員警建立** 的數據表] 畫面中，輸入：「我想儲存員工傳送的逾時要求。 數據表應該識別要求的開始和結束時間。
5.  選取 [ **資料表選項** ] 按鈕。 從出現的功能表中，選取 **[一個數據表**]。

![開始使用 Copilot 畫面的螢幕快照](media/60a2ec72988f48c91df7c370532cb331.png)

6.  選取 [ **產生]** 按鈕。

Copilot 應該已建立 **逾時要求** 數據表。 接下來，我們會在數據表中新增更多數據行。

7.  在 **[Copilot** ] 窗格中，輸入：「 *新增名為 [逾時原因] 的選擇數據行。*
8.  在 **[Copilot** ] 窗格中，個別新增下列提示。
    - *「新增名為「關閉時間類型」的選擇資料行。*
    - *「新增名為提交日期的 Date 資料行」。*
    - *「將選擇數據行新增至「逾時」要求數據表，稱為「核准狀態」。*
    - *「新增稱為「要求詳細數據」的多行文字數據行。*

    您的逾時資料表應該類似影像：

![已完成逾時要求數據表的螢幕快照 ](media/2ac256daafe1853e5367852467690c76.png)

接下來，我們將將用戶數據表新增至數據模型，以便將逾時要求與特定使用者產生關聯。

9.  在命令行上 **，選取 **[+ 現有數據表**]。**
10.  從 **[重新認可** ] 切換至 **[所有數據表**]。
11.  在 [ **搜尋]** 欄位中，輸入 **[使用者**]。
12.  選取 [ **使用者** ] 數據表，然後按下 [ **新增選取]** 按鈕。
13.  在命令行上 **，選取 [**建立關聯性**]。**
14.  設定關聯性，如下所示：
    -   **一：** 使用者
    -   **許多：** 逾時要求
    -   **顯示名稱：** 要求員工
15.  選取**完成**。

您已完成的資料模型應該類似下圖：

![已完成數據模型的螢幕快照 ](media/daa74d51e2ceada8e1e8b004cae9942a.png)

16.  選取 [ **儲存並開啟應用程式]** 按鈕。

> [!NOTE]
> 建立新應用程式可能需要幾分鐘的時間。

## 工作 2：個人化您的新應用程式

現在已建立您的新應用程式，我們將進行一些修改，以最符合我們的需求。 我們將從對歡迎畫面進行一些修改開始。

1.  開啟新的應用程式後，選取 [逾時要求] 文字**上方的 ****[影像**佔位符]。****
2.  從出現的功能表中，選取 [**編輯****\>上傳]。**
3.  選擇類別 **檔案資料夾中的 [逾時** ] 影像，然後選取 [ **開啟**]。
4.  接下來，選取 [使用者 **] 上方**的 [**影像**佔位符]。
5.  從出現的功能表中，選取 [**編輯****\>上傳]。**
6.  選擇類別檔案資料夾中的 **[員工** ] 映射，然後選取 [ **開啟**]。

接下來，我們將調整影像的大小，讓使用者更容易閱讀。 此外，我們將調整針對每個項目顯示的文字。

7.  在 **命令行**上，選取 [ **屬性]** 按鈕。 （*位於 [編輯] 按鈕右邊。*
8.  選取您稍早新增的 **逾時** 映像。
9.  在 [ **屬性]** 面板中，設定映射，如下所示：
    -   **影像位置：** 填滿
    -   **寬度：** 300
    -   **高度：** 300
10.  重複先前的步驟，將 [員工 **] 影像的 **Height** 和 **Width** 設定**為 **300** x **300**。
11.  選取 [逾時要求 **] 下方**的文字。
12.  在 [ **屬性]** 面板中，選取 **[文字** ] 字段，並將文字變更為：「 *建立、檢視及管理您逾時要求」。*
13.  選取**標頭**中的**歡迎畫面**文字。
14.  在右側的 [ **屬性** ] 窗格中，選取 [ **標誌** ] 字段。
15.  從出現的功能表中，選取 [ **上傳**]。
16. 從類別檔案中 **選取 Contoso Logo** ，然後選取 [ **開啟**]。
17. 在 [**樣式**和主題] 群組底下的 **[屬性**] 面板中，選取 **[填滿**色彩] 圖示。
18. 選取 [自定義]** 索引**標籤
19. 將 **十六進位** 色彩變更為： **101E2B**
20. 請確定您仍然已**選取標題**，並將標題**變更**為 Contoso Employee Hub

您的應用程式會類似影像。

![畫布應用程式歡迎畫面的螢幕快照。](media/533c80cc861941b6a353b56bfc0dbc0f.png)

## 工作3：將新畫面新增至您的應用程式。

當您建置應用程式時，您的其中一位經理會觸達您，並想知道員工是否可以使用此應用程式來檢查設備。 Contoso 已經在 Dataverse 中儲存設備結帳資訊，因此這隻是在應用程式中提供信息的問題。

1.  在您的應用程式仍然開啟時，如有必要，請展開 **[Copilot** ] 窗格。 在 Copilot 中，輸入下列內容：「*新增名為設備結帳的新畫面」。*  選取 [*傳送]。。*
2.  選取 [ **保留它]** 按鈕以接受畫面。
3.  應用程式會新增名為 **[設備簽出** ] 的新畫面。
4.  在 [**設備簽出] 畫面上，按兩下 **[使用配置**]，然後選擇 **[提要**列**配置]。
5.  展開不同的容器，直到**顯示 SideBarContainer**** 為止。**

![樹視圖的螢幕快照 ](media/cde6257402b7a8786e679ab64ee0f882.png)

6.  以滑鼠右鍵按兩下 **SidebarContainer** ，然後重新命名為 **EquipContainer1**。
7.  **選取 [EquipContainer1**] 容器后，按兩下 [**開啟插入] 功能表**按鈕。
8.  在 [搜尋 **] 視窗中，輸入 **[** 資源庫**]，然後選取 [**垂直資源庫**]。
9.  在 [ **搜尋** ] 字段中，輸入 **[設備**]，然後選取 **[設備** ] 數據表。
10. 在 **畫面左側的 [樹視圖** ] 中，選取您剛才新增的 **Gallery1** 控件。
11. 以滑鼠右鍵按下資源庫名稱，選擇 **[重新命名**]，然後重新命名為 **[設備清單**]。
12. 將滑鼠停留在 **設備清單** 資源庫上方的工具列上，選取 [ **配置**]。
13. 選取 [ **標題和副標題配置** ] 選項。
14. 選取 [設備清單**庫] 後**，在 [**屬性**] 窗格中，設定如下：
    -   **寬度：** 360
    -   **彈性高度：** 開啟
    -   **最低高度：** 287

接下來，我們要將額外的容器新增至 **EquipmentContiner1** 容器，以儲存我們將用來篩選設備列表**資源庫內容的**搜尋控件。

15.  在 **[樹** 視圖] 中，選取 **[EquipContainer1**]。
16.  將滑鼠停留在容器上，然後選取 **[Copilot** ] 圖示。
17.  輸入下列文字：「*插入水準容器」。*

![將資源庫插入容器的螢幕快照。](media/b9b784ea5625469c8785650b977f32d1.png)

18.  選取 [ **保留它]** 按鈕。
19.  新的容器將會新增至 EquipContainer1** 容器底部**。
20.  在 [樹視圖] 中 **，按住並拖曳新的容器，並將它放在 [設備清單 **] 資源庫上方**。**
21.  將容器重新命名為 **EquipSearchContainer。**
22.  選取 **[EquipSearchContainer** ]，在 [ **屬性** ] 窗格中，設定如下：
    -   **最小寬度：** 0
    -   **彈性高度：** 關閉
    -   **高度：** 44
23.  選取 **[EquipSearchContainer** ] 后，選取 [ **開啟插入] 功能表** 按鈕。
24. 在 [ **搜尋** ] 欄位中，輸入 **文字**，然後選取 [ **文字輸入**]。
25. 將 [ **文字輸入** ] 字段重新命名為 **EquipSearchInput**。
26. 選取 **[EquipSearchInput** ]，在 [ **屬性** ] 窗格中，設定如下：
    -   **預設值：** 空白（無）
    -   **提示文字：** 搜尋
    -   **字型：** 開啟 Sans
    -   **字型大小：** 14
    -   **填補**
        -   **頂端：** 5
        -   **Bottom：** 5
        -   **左：** 12
        -   **右：** 5
    -   **高度：** 44
    -   **彈性寬度：** 開啟
    -   **最小寬度：** 0

        ![搜尋輸入屬性的螢幕快照。](media/b0e092b4795edf58dad1153209639051.png)

27. 在 **[樹視圖]** 中 **，選取 [EquipSearchContainer]。**
28. 將滑鼠停留在容器上，選取 **[Copilot** 圖示]，然後輸入 *「新增搜尋圖示」。*
29. 選取 [**保留]。**
30. 選取 [搜尋 **] 圖示之後**，在 **[屬性**] 窗格中，設定控件，如下所示：
    -   **填補**
        -   **頂端：** 10
        -   **博頓：** 10
        -   **左：** 10
        -   **右：** 10
    -   **高度：** 44
    -   **寬度：** 44

![搜尋圖示屬性的螢幕快照](media/cb3305731a09bca0bbf166d55d9822a4.png)

31. 使用左側的 **[樹視圖** ]，選取 **[EquipSearchContainer]。**
32. 在 [ **屬性]** 窗格中，設定容器，如下所示：
    -   **最小寬度：** 0
    -   **高度：** 44

最後，我們將設定 **設備清單** 庫，根據搜尋控制欄位中輸入的文字填入其數據。

33.  選取我們稍早建立的設備 **清單** 資源庫。
34.  在 **Items** 屬性中，輸入下列公式：Search（[@'Equipment']， *EquipmentSearchInput*。文字，『設備名稱』，類別）

![Items PowerFx 公式的螢幕快照。](media/4fbff5852c0e1db6cece816734418e07.png)

## 工作 4：建置容器以顯示記錄作業。

當使用者在 [設備] 列表中選取記錄時，我們想要在另一個容器中開啟記錄，以允許他們編輯選取的記錄。

1.  **選取MainContainer**。
2.  在 **MainContainer**上，選取 [ **開啟插入] 功能表** 按鈕。
3.  在 [搜尋 **] 檔案中**，輸入 **[容器**]，然後選擇 [**垂直容器**]。
4.  以滑鼠右鍵按兩下容器，然後將 **容器重新命名** 為 **RecordDetails**。
5.  在 **RecordDetails** 容器上，選取 [ **開啟插入] 功能表** 按鈕。
6.  在 [ **插入]** 功能表上，選取 [ **編輯表單]**。
7.  在 [選取數據源] 畫面中，選取 [ **設備**]。 *（填入數據最多可能需要 30 秒的時間。*
8.  以滑鼠右鍵按下您剛才新增的表單，並將 **它重新命名** 為 **EquipmentForm**。
9.  在 [屬性] 窗格中，選取 [****進階**] 索引卷標，並將 [專案 **] 屬性設定**為：*[設備清單*]。** 選擇。 *（這會以目前選取的記錄填入表單。*
10. 選取 [ **顯示** ] 索引標籤，然後設定表單，如下所示：
    -   **欄：** 2
    -   **默認模式：** 編輯

現在我們要新增另一個容器，以用來控制表單上的作業。

11.  請確定您已 **選取 MainContainer** 。
12.  **選取出現的 Copilot** 圖示。 輸入下列內容：「 *插入水準容器」。*
13.  選取 [**保留]。**
14.  以滑鼠右鍵按兩下容器，並將 **它重新命名** 為 **SelectedRecord1**
15.  使用**樹**視圖，將 **SelectedRecord1** 容器移至 RecordDetails** 容器上方**。
16.  設定 **SelectedRecord1** 容器，如下所示：
    -   **最小寬度：** 250
    -   **彈性高度：** 關閉
    -   **高度：** 50
17.  選取 SelectedRecord1 **** 容器後，選取 [**開啟插入] 功能表**按鈕。
18.  選取 **[文字卷標]。**
19.  **將標籤重新命名為** SelectedRecordTitle
20. 選取 [**保留]。**
21. 設定 **SelectedRecordTitle** ，如下所示：
    1.  **填補**
        1.  **頂端：** 5
        2.  **底部：** 5
        3.  **左：** 30
        4.  **高度：** 40
    2.  **彈性寬度：** 開啟
    3.  **最小寬度：** 150
22. **選取 SecondRecord1** 容器，選取 [**插入]** 按鈕。
23. 在 [ **搜尋]** 字段中，輸入 **[儲存**]，然後選取 [ **儲存]** 圖示。
24. 設定 [儲存] **** 按鈕，如下所示：
    -   **高度：** 40
    -   **寬度：** 40
25. 選取 OnSelect **** 屬性，然後輸入下列公式。 SubmitForm（EquipmentForm）。

![OnSelect PowerFx 公式的螢幕快照。](media/e5b22c91a437e6918269d65e2616afc8.png)

## 工作 5：修改頁面上的標頭

建立此畫面的最後一個步驟是使用數據填入讀取器容器。

1.  **選取應用程式頂端的 HeaderContainer**。
2.  選取 [ **開啟插入] 功能表** 按鈕。
3.  選取**文字標籤**。
4.  **設定文字標籤**，如下所示：
    -   **文字：** 設備結帳
    -   **字型：** 開啟 Sans
    -   **字型大小：** 16
    -   **字型粗細：** 半Bold
        -   **填補：** 16
        -   **底部：** 16
        -   **左：** 16
        -   **右：** 16
    -   **高度：** 40
    -   **彈性寬度：** 開啟

        ![文字標籤屬性的螢幕快照。](media/088cafeec651b099fa49ac1f151cd228.png)

5.  選取 HeaderContainer **，選擇 **[插入**]，然後選取 [**首頁圖示**]。**
6.  將 **首頁按鈕的 OnSelect** 屬性設定為：Back（）

![[上一頁] 瀏覽命令的螢幕快照。](media/38d0e5367ee41da58ac9902f8056b1af.png)

## 工作 6：完成設定歡迎畫面

經過檢閱，我們決定不需要在此應用程式中建立使用者，因此我們將變更歡迎畫面，讓您存取設備結帳。

7.  使用 **樹視圖**，選取歡迎 **畫面**。
8.  選取 [使用者 **] 上方**的 **[影像**]。
9.  從出現的功能表中，選取 [ **編輯**]，然後選擇 [ **上傳**]。
10.  在 **學生資料夾中找出 [設備** ] 映射，然後選擇 [ **開啟**]。
11.  **將影像的 OnSelect** 屬性設定為：Navigate（*'Equipment Checkout'*）
12.  選取 [**使用者**] 文字，並將 [文字 **] 屬性設定**為 **[設備**]。
13.  選取 [設備 **] 下方**的 ****[文字]，並將 Text**** 屬性變更為：取出設備並編輯保留。

![計算機 AI 產生的內容螢幕快照可能不正確。](media/561d1e8cd023541761b6523138c2fde8.png)

## 工作 7：測試您的應用程式

1.  在 **命令行**上，選取 [ **播放]** 按鈕。
2.  **選取 [設備**] 映射。
3.  在 [**搜尋**] 欄位中，輸入 **[電子]。** （*請注意清單*篩選的方式）
4.  選取膝上型 **電腦** 記錄。
5.  將 [類別 **] **變更為 **[傢俱**]。
6.  選取 [儲存]**** 按鈕。
7.  請注意膝上型計算機類別**如何變更為 **[傢俱**]。**
8.  選取 [ **首頁]** 按鈕。
9.  選取 [ **紫色 X** ] 以離開 **預覽** 模式。

## 工作 8：儲存併發佈應用程式

**目標：** 儲存併發佈應用程式，使其可在網頁瀏覽器、行動裝置或 SharePoint 或 Teams 等內嵌平台之間存取。

1.  在 Power Apps Studio 中，選取 [ **儲存]** 按鈕。
2.  在 [ **另存** 新檔] 畫面中，將 [ **名稱** ] 設定為 **[Contoso Employee Hub**]，選取 [ **儲存**]。
3.  選取 [發佈] 按鈕。
