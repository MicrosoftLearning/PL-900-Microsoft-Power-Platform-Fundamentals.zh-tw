---
lab:
  title: 實驗室3：建立畫布應用程式
  learning path: 'Learning Path: Demonstrate the capabilities of Microsoft Power Apps'
  module: 'Module 2: Build a canvas app'
---
## 學習目標

在此練習中，您將使用 Copilot 建立畫布應用程式，讓員工可用來要求和管理休息時間及設備結帳要求。 建立應用程式之後，您將使用 Copilot 和 Power Apps 設計工具來修改應用程式。

完成此實驗室之後，您將：

- 使用 Copilot 協助您建立數據模型以支援您的應用程式。
- 修改畫布應用程式。

### 案例

Contoso 諮詢是一個專業服務組織，專門從事 IT 和 AI 諮詢服務。 他們想要建立員工可用來要求休息時間的休息應用程式。

### 實驗室詳細數據

開始本練習之前，您必須先完成下列實驗室：

- **實驗室 2 – 建立數據模型**

> **重要** 此實驗室會使用 AI 來建置元件。 由於 AI 結果可能會有所不同，因此請務必注意，您的結果可能會與實驗室中定義的結果不同（但類似）。 實驗室中概述的基本概念將會是相同的，無論所建立的專案或所命名的內容為何。 如果數據表和數據行不完全相符，您可能需要調整為您建立的專案。

完成此練習的估計時間為 **60 到 75** 分鐘。

## 工作 1：登入 Power Apps 並探索介面

1.  開啟網頁瀏覽器並流覽至 [Power Apps](https://make.powerapps.com/) 製作者入口網站。
1.  使用左側導覽，選取 [ **建立**]。
1.  在 [建立您的應用程式 **] 下**，選擇 [**開始使用 Copilot**]。
1.  在 [ **描述您想要 copilot 建置** 的數據表] 畫面中，輸入： *` I want to store time off requests sent by employees. The table should identify the start and end times of the request.`*
1.  選取 [ **資料表選項** ] 按鈕。 從出現的功能表中，選取 **[一個數據表**]。

    ![開始使用 Copilot 畫面的螢幕快照](media/60a2ec72988f48c91df7c370532cb331.png)

1.  選取 [ **產生]** 按鈕。

    Copilot 應該已建立 **逾時要求** 數據表。 接下來，我們會在數據表中新增更多數據行。

    **注意**：如有必要，請新增數據表名稱以提示。

1.  在 **[Copilot** ] 窗格中，輸入： *`Add a choice column called Time Off Reason.`*
1.  在 **[Copilot** ] 窗格中，個別新增下列提示。
    - *`Add a choice column named Time off Type.`*
    - *`Add a Date column called Submission Date.`*
    - *`Add a choice column to the Time Off request table called Approval Status.`*
    - *`Add a multi-line text column called Request Details.`*

    您的逾時資料表應該類似影像：

    ![已完成逾時要求數據表的螢幕快照 ](media/2ac256daafe1853e5367852467690c76.png)

    接下來，我們將將用戶數據表新增至數據模型，以便將逾時要求與特定使用者產生關聯。

1.  在命令行上 **，選取 **[+ 現有數據表**]。**
1.  從 **[重新認可** ] 切換至 **[所有數據表**]。
1.  在 [ **搜尋]** 欄位中，輸入 **[使用者**]。
1.  選取 [ **使用者** ] 數據表，然後按下 [ **新增選取]** 按鈕。
1.  在命令行上 **，選取 [**建立關聯性**]。**
1.  設定關聯性，如下所示：

    -   **一：** 使用者
    -   **許多：** 逾時要求
    -   **顯示名稱 **`Requesting Employee`
  
1.  選取**完成**。

    您已完成的資料模型應該類似影像：

    ![已完成數據模型的螢幕快照 ](media/daa74d51e2ceada8e1e8b004cae9942a.png)

1.  選取 [ **儲存並開啟應用程式]** 按鈕。

> [!NOTE]
> 建立新應用程式可能需要幾分鐘的時間。

## 工作 2：個人化您的新應用程式

現在已建立您的新應用程式，我們將進行一些修改，以最符合我們的需求。 我們將從對歡迎畫面進行一些修改開始。

1.  開啟新的應用程式後，選取 [逾時要求 **] 文字上方的 ****[影像**佔位符]。
1.  從出現的功能表中，選取 [**編輯****\>上傳]。**
1.  選擇類別 **檔案資料夾中的 [逾時** ] 影像，然後選取 [ **開啟**]。
1.  接下來，選取 [使用者 **] 上方**的 [**影像**佔位符]。
1.  從出現的功能表中，選取 [**編輯****\>上傳]。**
1.  選擇類別檔案資料夾中的 **[員工** ] 映射，然後選取 [ **開啟**]。

    接下來，我們將調整影像的大小，讓使用者更容易閱讀。 此外，我們將調整針對每個項目顯示的文字。

1.  在 **命令行**上，選取 [ **屬性]** 按鈕。 （*位於 [編輯] 按鈕右邊。*
1.  選取您稍早新增的 **逾時** 映像。
1.  在 [ **屬性]** 面板中，設定映射，如下所示：
    
    -   **影像位置：** 填滿
    -   **寬度：** 300
    -   **高度：** 300
      
1.  重複先前的步驟，將 [員工 **] 影像的 **Height** 和 **Width** 設定**為 **300** x **300**。
1.  選取 [逾時要求 **] 下方**的文字。
1.  在 [ **屬性]** 面板中，選取 [ **文字** ] 欄位，並將文字變更為： *`Create, View, and Manage you time off requests.`*
1.  選取**標頭**中的**歡迎畫面**文字。
1.  在右側的 [ **屬性** ] 窗格中，選取 [ **標誌** ] 字段。
1.  從出現的功能表中，選取 [ **上傳**]。
1. 從類別檔案中 **選取 Contoso Logo** ，然後選取 [ **開啟**]。
1. 在 [**樣式**和主題] 群組底下的 **[屬性**] 面板中，選取 **[填滿**色彩] 圖示。
1. 選取 [自定義]** 索引**標籤
1. 將 **十六進位** 色彩變更為： `101E2B`
1. 請確定您仍然已 **選取 [標頭** ]，並將 [ **標題** ] 變更為 `Contoso Employee Hub`。
1. 在 **命令行** 上，選取 [ **儲存** ] 按鈕以儲存應用程式。
1. 在 [ **儲存]** 畫面中，將 [ **名稱** ] 設定為 `Contoso Employee Hub`，然後選取 [ **儲存]。**

    您的應用程式會類似影像。

    ![畫布應用程式歡迎畫面的螢幕快照。](media/533c80cc861941b6a353b56bfc0dbc0f.png)

## 工作3：將新畫面新增至您的應用程式。

當您建置應用程式時，您的其中一位經理會觸達您，並想知道員工是否可以使用此應用程式來檢查設備。 Contoso 已經在 Dataverse 中儲存設備結帳資訊，因此這隻是在應用程式中提供信息的問題。

1.  當您的應用程式仍然開啟時，請展開 **[Copilot** ] 窗格（如有必要）。 在 Copilot 中，輸入下列專案： *`Add a new screen called Equipment Checkout.`*
1.  請選取**傳送**。
1.  選取 [ **保留它]** 按鈕以接受畫面。
1.  應用程式會新增名為 **[設備簽出** ] 的新畫面。
1.  在 [**設備簽出] 畫面上，按兩下 **[使用配置**]，然後選擇 **[提要**列**配置]。
1.  展開不同的容器，直到 **顯示 SideBarContainer** 為止。

    ![樹視圖的螢幕快照 ](media/cde6257402b7a8786e679ab64ee0f882.png)

1.  以滑鼠右鍵按兩下 **SidebarContainer** ，然後重新命名為 **EquipContainer1**。
1.  **選取 [EquipContainer1**] 容器后，按兩下 [**開啟插入] 功能表**按鈕。
1.  在 [搜尋 **] 視窗中，輸入 **[** 資源庫**]，然後選取 [**垂直資源庫**]。
1.  當系統要求您在出現的 [搜尋 **] 字段中提供數據源**時，請輸入 **[設備]，然後選取 **[設備**]** 數據表。
1. 在 **畫面左側的 [樹視圖** ] 中，選取您剛才新增的 **Gallery1** 控件。
1. 以滑鼠右鍵按下資源庫名稱，選擇 **[重新命名**]，然後重新命名為 `Equipment List`。
1. 將滑鼠停留在 **設備清單** 資源庫上方的工具列上，選取 [ **配置**]。
1. 選取 [ **標題和副標題配置** ] 選項。
1. 選取 [設備清單**庫] 後**，在 [**屬性**] 窗格中，設定如下：

    -   **Width**: `360`
    -   **彈性高度：** 開啟
    -   **最小高度：** `287`

    接下來，我們要將額外的容器新增至 **EquipmentContiner1** 容器，以儲存我們將用來篩選設備列表**資源庫內容的**搜尋控件。

1.  在 **[樹** 視圖] 中，選取 **[EquipContainer1**]。
1.  將滑鼠停留在容器上，然後選取 **[Copilot** ] 圖示。
1.  輸入下列文字： *`Insert a Horizontal container.`*

    ![將資源庫插入容器的螢幕快照。](media/b9b784ea5625469c8785650b977f32d1.png)

1.  選取 [ **保留它]** 按鈕。
1.  新的容器將會新增至 EquipContainer1** 容器底部**。
1.  在 [樹視圖] 中 **，按住並拖曳新的容器，並將它放在 [設備清單 **] 資源庫上方**。**
1.  將容器重新命名為 `EquipSearchContainer`。
1.  選取 **[EquipSearchContainer** ]，在 [ **屬性** ] 窗格中，設定如下：
    
    -   **最小寬度：** `0`
    -   **彈性高度：** 關閉
    -   **Height**: `44`
    
1.  選取 **[EquipSearchContainer** ] 后，選取 [ **開啟插入] 功能表** 按鈕。
1. 在 [ **搜尋** ] 字段中，輸入 **[文字**]，然後選取 [ **文字輸入**]。
1. 將 [ **文字輸入** ] 欄位重新命名為 `EquipSearchInput`。
1. 選取 **[EquipSearchInput** ]，在 [ **屬性** ] 窗格中，設定如下：

    -   **預設值：** 空白（無）
    -   **提示文字：** 搜尋
    -   **字型：** 開啟 Sans
    -   **字型大小：** 14
    -   **填補** （下面的值可能已經存在。
        -   **頂端：** 5
        -   **Bottom：** 5
        -   **左：** 12
        -   **右：** 5
    -   **高度：** 44
    -   **彈性寬度：** 開啟
    -   **最小寬度：** 0

        ![搜尋輸入屬性的螢幕快照。](media/b0e092b4795edf58dad1153209639051.png)

1. 在 **[樹視圖]** 中 **，選取 [EquipSearchContainer]。**
1. 將滑鼠停留在容器上，選取 **Copilot** 圖示，然後輸入 *`Add a Search Icon.`*
1. 選取 [**保留]。**

    > **注意：** 如果 Copilot 發生新增錯誤的圖示，請將其移除並手動插入放大鏡。

1. 選取 [搜尋 **] 圖示之後**，在 **[屬性**] 窗格中，設定控件，如下所示：

    -   **填補**
        -   **頂端：** 10
        -   **博頓：** 10
        -   **左：** 10
        -   **右：** 10
    -   **高度：** 44
    -   **寬度：** 44

    ![搜尋圖示屬性的螢幕快照](media/cb3305731a09bca0bbf166d55d9822a4.png)

1. 使用左側的 **[樹視圖** ]，選取 **[EquipSearchContainer]。**

    最後，我們將設定 **設備清單** 庫，根據搜尋控制欄位中輸入的文字填入其數據。

1.  選取我們稍早建立的設備 **清單** 資源庫。
1.  在 **Items** 屬性中，輸入下列公式： `Search([@'Equipments'], EquipSearchInput.Text, 'Equipment Name',Category)`

    ![Items PowerFx 公式的螢幕快照。](media/powerfx-formula.png)

1. 在 **命令行** 上，選取 [ **儲存** ] 按鈕以儲存您的應用程式。

> **重要事項：** 如果您將公式複製並貼入公式列，則 “' 對 [設備及設備名稱] 可能不正確。 如果您收到公式錯誤，請嘗試移除並重新套用它們。

## 工作 4：建置容器以顯示記錄作業。

當使用者在 [設備] 列表中選取記錄時，我們想要在另一個容器中開啟記錄，以允許他們編輯選取的記錄。

1.  **選取 MainContainer** 並將它重新命名為 `DetailsContainer`。
1.  在 **[詳細數據][容器**] 上，選取 [ **插入]** 按鈕。
1.  在 [搜尋 **] 檔案中**，輸入 **[容器**]，然後選擇 [**垂直容器**]。
1.  以滑鼠右鍵按鍵按鍵 ，然後將 **容器重新命名** 為 `RecordDetails`。
1.  在 **RecordDetails** 容器上，選取 [ **插入]** 按鈕。
1.  在 [ **插入]** 功能表上，選取 [ **編輯表單]**。
1.  在 [選取數據源] 畫面中，選取 [ **設備**]。 *（填入數據最多可能需要 30 秒的時間。*
1.  以滑鼠右鍵按下您剛才新增的表單，並將 **它重新命名** 為 `EquipmentForm`。
1.  在 [屬性]** 窗格中，選取 **[** 進階**] 索引卷標，並將 [專案 **] 屬性設定**為： `'Equipment List'.Selected` *（這會填入窗體中目前選取的記錄。*
1. 選取 [ **顯示** ] 索引標籤，然後設定表單，如下所示：

    -   **欄：** 2
    -   **默認模式：** 編輯

    現在我們要新增另一個容器，以用來控制表單上的作業。

1.  請確定您已 **選取 [詳細數據** ][容器]。
1.  **選取出現的 Copilot** 圖示。 輸入下列專案： *`Insert a horizontal container.`*
1.  選取 [**保留]。**
1.  以滑鼠右鍵按兩下容器，並將 **它重新命名** 為 `SelectedRecord1`
1.  使用**樹**視圖，將 **SelectedRecord1** 容器移至 RecordDetails** 容器上方**。
1.  設定 **SelectedRecord1** 容器，如下所示：
    
    -   **最小寬度：** 250
    -   **彈性高度：** 關閉
    -   **高度：** 50
    
1.  選取 SelectedRecord1 **** 容器後，選取 [**插入]** 按鈕。
1.  選取 **[文字卷標]。**
1.  將標籤重新命名為 `SelectedRecordTitle`。
1. 設定 **SelectedRecordTitle** ，如下所示：

    1.  **填補**
        1.  **頂端：** 5
        2.  **底部：** 5
        3.  **左：** 30
        4.  **右：** 5
    2.  **彈性寬度：** 開啟
    3.  **最小寬度：** 150
    4.  **高度：** 40
       
1. **選取 SecondRecord1** 容器，選取 [**插入]** 按鈕。
1. 在 [ **搜尋]** 字段中，輸入 **[儲存**]，然後選取 [ **儲存]** 圖示。
1. 設定 [儲存] **** 按鈕，如下所示：

    -   **高度：** 40
    -   **寬度：** 40
      
1. 選取 OnSelect **** 屬性，然後輸入下列公式：`SubmitForm(EquipmentForm)`。

    ![OnSelect PowerFx 公式的螢幕快照。](media/e5b22c91a437e6918269d65e2616afc8.png)

## 工作 5：修改頁面上的標頭

建立此畫面的最後一個步驟是使用數據填入讀取器容器。

1.  **選取應用程式頂端的 HeaderContainer**。
1.  選取 [ **插入]** 按鈕。
1.  選取**文字標籤**。
1.  **設定文字標籤**，如下所示：
   
    -   **Text**: `Equipment Checkout`
    -   **字型：** 開啟 Sans
    -   **字型大小：** 16
    -   **字型粗細：** 半Bold
    -  **填補**
        -   **頂端：** 16
        -   **底部：** 16
        -   **左：** 16
        -   **右：** 16
    -   **高度：** 40
    -   **彈性寬度：** 開啟

        ![文字標籤屬性的螢幕快照。](media/088cafeec651b099fa49ac1f151cd228.png)

1.  選取 HeaderContainer **，選擇 **[插入**]，然後選取 [**首頁圖示**]。**
1.  將 **首頁按鈕的 OnSelect** 屬性設定為： `Back()`

    ![[上一頁] 瀏覽命令的螢幕快照。](media/38d0e5367ee41da58ac9902f8056b1af.png)

## 工作 6：完成設定歡迎畫面

經過檢閱，我們決定不需要在此應用程式中建立使用者，因此我們將變更歡迎畫面，讓您存取設備結帳。

1.  使用 **樹視圖**，選取歡迎 **畫面**。
1.  選取 [使用者 **] 上方**的 **[影像**]。
1.  從出現的功能表中，選取 [ **編輯**]，然後選擇 [ **上傳**]。
1.  在 **學生資料夾中找出 [設備** ] 映射，然後選擇 [ **開啟**]。
1.  將 **影像的 OnSelect** 屬性設定為： `Navigate('Equipment Checkout')`
1.  選取 [**使用者**] 文字，並將 Text** 屬性設定**為 `Equipment`。
1.  選取 [設備 **] 下方**的 **[文字**]，**並將 Text** 屬性變更為：`Check out equipment and edit reservations`。

    ![計算機 AI 產生的內容螢幕快照可能不正確。](media/561d1e8cd023541761b6523138c2fde8.png)

1. 選取 [儲存 **]** 按鈕以儲存您的應用程式。

## 工作 7：測試您的應用程式

1.  在 **命令行**上，選取 [ **播放]** 按鈕。
1.  **選取 [設備**] 映射。
1.  在 [**搜尋**] 欄位中，輸入 **[電子]。** （*請注意清單*篩選的方式）
1.  選取膝上型 **電腦** 記錄。
1.  將 [類別 **] **變更為 **[傢俱**]。
1.  選取 [儲存]**** 按鈕。
1.  請注意膝上型計算機類別**如何變更為 **[傢俱**]。**
1.  選取 [ **首頁]** 按鈕。
1.  選取 [ **紫色 X** ] 以離開 **預覽** 模式。

## 工作 8：儲存併發佈應用程式

**目標：** 儲存併發佈應用程式，使其可在網頁瀏覽器、行動裝置或 SharePoint 或 Teams 等內嵌平台之間存取。

1.  在 Power Apps Studio 中，選取 [ **儲存]** 按鈕。
1.  選取 [發佈] 按鈕。
1.  選擇 [ **發佈此版本]。**

