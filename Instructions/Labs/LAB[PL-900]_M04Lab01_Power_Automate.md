---
lab:
  title: '實驗室 4:如何建立自動化解決方案'
  module: 'Module 4: Get Started with Power Automate'
---

# 實驗室 4:如何建立自動化解決方案

**WWL 租用戶 - 使用條款**如果您針對講師導向訓練交付的一部分取得租用戶，請注意，租用戶的功能是為了在講師導向訓練中支援實際操作實驗室。 租用戶不應共用，或用於實際操作實驗室以外的用途。 本課程中使用的租用戶是試用租使用者，在課程結束后無法使用或存取租使用者，且不符合延伸模塊的資格。 租用戶不得轉換成付費訂用帳戶。 此課程中提供的租用戶仍是 Microsoft Corporation 的財產，我們保留隨時取得存取權和重新持有的權利。 

## 案例

貝洛斯學院是一個具有多個校園和課程的教育組織。 許多貝洛學院的講師和系統管理員需要參加活動，並購買專案。 從歷史上看，追蹤這些費用是一個挑戰。 

校園管理希望藉由提供員工報告費用的數位方式，將費用報告系統現代化。 

在整個課程中，您將建置應用程式和執行自動化，讓Bellows 學院員工能夠管理費用。 

在此實驗室中，您將建立Power Automate流程，以在建立新的費用報表時傳送費用報表復本的電子郵件。

## 高階實驗室步驟

下列已識別為必須實作以完成專案的必要項目：

- 提交費用報表時，員工必須收到電子郵件。 

### 必要條件

- 課程模組 1 實驗室 0 完成 **- 驗證實驗室環境**

## 練習 1：建立費用報表通知流程

**目標：** 在此練習中，您將建立可實作需求的 Power Automate 流程。 

### 工作 #1：建立流程

1. 導覽到 https://make.powerapps.com

1. 您可能需要重新驗證、選取 **[登入** ]，並視需要遵循指示。

1. **如果尚未選取，請選取右上方的 [開發 One**] 環境。

1. 在左側導覽中，選取 [流程]****。

1. 如果出現提示，請選取 [開始]****。

1. 選取 [新增流程]****，然後選取 [自動化雲端流程]****。

1. 輸入 Flow 名稱**的費用**通知。

1. 在 **[選擇流程的觸發程式**] 中，搜尋Dataverse

1. 選擇 [新增、修改或刪除**數據列時] 觸發程式**，然後選取 [**建立**]。

1. 填入流程的觸發條件：

    1. 為 [變更類型]**** 選取 [已新增]****
    
    1. ****選擇 [資料表名稱的費用報表**]**

    1. 針對 [範圍] **** 選取 [組織]****

    1. 選取觸發程序步驟上的省略符號 ( [...])****，然後選取 [重新命名]****。 重新命名觸發程式步驟 `When an Expense Report is added` 

這是很好的作法，因此您和其他流程編輯器可以瞭解步驟的目的，而不需要深入瞭解詳細數據。

### 工作 #2：建立步驟以取得費用報表數據列

1. 選取 **+ 新步驟**。 此步驟會擷取訪客資訊，包括電子郵件地址。

1. 搜尋 Dataverse

1. 選取**依識別碼取得資料列**動作。

1. 選取 **[使用者** ] 作為 **[資料表名稱]**

1. 選取 [資料列識別碼]**** 欄位。 請注意，會出現視窗提示您選取 [Dynamic 內容]**** 或 [運算式]****。

1. 在 [**數據列標識符**] 字段中，從 **[動態內容**] 列表中選取 [**擁有者][值**]。 在此步驟中，您要查閱建立來觸發此流程之費用報表數據列的擁有者。 

1. 在 [取得資料列 ID] **** 動作中選取觸發程序步驟上的省略符號 ( [...])****，然後選取 [重新命名]****。 重新命名此動作 取得擁有者

這是很好的作法，因此您和其他流程編輯器可以瞭解步驟的目的，而不需要深入瞭解詳細數據。

### 工作 #3：建立步驟以傳送電子郵件給訪客

1. 選取 **+ 新步驟**。 這是會將電子郵件傳送給訪客的步驟。

1. 搜尋郵件，從 Office 365 Outlook 連接器選取 **[傳送電子郵件 （V2）**] 動作 **。**

1. 如果系統提示您接受使用此動作的條款及條件，請選取 [接受]****。

1. 選取 [ **收件者]** 字段，然後輸入您的個人電子郵件位址。 （有許多方式可以動態填入電子郵件位址，但在此練習中，我們將手動指派。  

1. 在 [ **主旨]** 欄位中，輸入已提交您的費用報告

1. 在 [電子郵件本文] **** 輸入下列文字：

名稱括以括號的欄位，必須置入動態內容。 建議您先複製並貼上所有文字，然後在正確的位置新增動態內容。

    Dear {First Name},
    
    Thank you for submitting your expense report for the total amount of {Report Total Amount} with a due date of {Report Due Date}.
    
     
    Best regards,
    Campus Administration
    Bellows College

1. 醒目提示 **{First Name}** 文字。 將它取代為 [取得擁有者 **] 步驟中的 **[**名字]** 字段。

1. 反白顯示 **{Report Total Amount}** 文字。 將它取代為 **[新增**瀏覽時的總金額]** 欄位**。

1. 反白顯示 **{報表到期日}** 文字。 將它取代為 **[新增造訪**時間] 步驟中的 **[報告到期日]** 字段。

1. 選取 [儲存]。

保持流程索引標籤開啟，以供下一個工作使用。 您的流程看起來應該如下所示：

![剛建立流程的螢幕快照](media/lab-4-create-an-automated-solution-01.png)

### 工作 #4：驗證和測試流程

1. 在瀏覽器中開啟新索引標籤，然後瀏覽至 https://make.powerapps.com。

1. **如果尚未選取，請選取右上方的 [開發 One**] 環境。

1. 選取 **[應用程式** ]，然後開啟 **Expense Tracker 應用程式**。

1. 保持此瀏覽器索引標籤處於開啟狀態，然後導覽回之前的流程索引標籤。

1. 在命令列上，選取 [測試]****。 選取 [手動]**** 然後選取 [測試]****。

1. 保持模型驅動應用程式開啟，並巡覽至瀏覽器索引標籤。

1. 使用左側的 [網站地圖] 導覽，選取 [ **費用報表**]。

1. 選取 [ **+ 新增** ] 按鈕以新增 **費用報表** 記錄。

1. **完成費用報表記錄**，如下所示：

    - **報表名稱：** 測試報表

    - **報表總金額：** $750.00

    - **報告到期日：** 明天 

1. 選取 [儲存 &amp; 關閉]**** 按鈕。

1. 導覽至流程測試執行的瀏覽器索引標籤。 短暫延遲之後，您應該會看到流程正在執行。 您可以在其中攔截任何流程中的問題，或確認流程已成功執行。

短暫延遲之後，您應該會在收件匣中看到電子郵件。 

>**注意：** 它可能會移至您的垃圾郵件資料夾。
