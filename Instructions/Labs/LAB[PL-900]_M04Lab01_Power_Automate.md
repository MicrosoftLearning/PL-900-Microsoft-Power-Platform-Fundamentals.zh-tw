---
lab:
  title: '實驗室 4:如何建立自動化解決方案'
  module: 'Module 4: Describe building automation with Microsoft Power Automate'
---

# 實驗室 4:如何建立自動化解決方案

**WWL 租用戶 - 使用條款**如果您針對講師導向訓練交付的一部分取得租用戶，請注意，租用戶的功能是為了在講師導向訓練中支援實際操作實驗室。 租用戶不應共用，或用於實際操作實驗室以外的用途。 本課程中使用的租用戶是試用租用戶，在課程結束後無法使用或存取租用戶，且不符合延伸模組的資格。 租用戶不得轉換成付費訂用帳戶。 此課程中提供的租用戶仍是 Microsoft Corporation 的財產，我們保留隨時取得存取權和重新持有的權利。 

## 案例

Bellows College 是一所教育組織，有多個校園和多項課程。 許多 Bellow College 的講師和管理員需要參加活動，並購買項目。 從歷史上來看，追蹤這些費用是一大挑戰。 

校園管理希望為員工提供數位方式來報告費用，藉此將費用報告系統現代化。 

在這整個課程中，您將建置應用程式及執行自動化，讓 Bellows College 員工能夠管理費用。 

在此實驗室中，您將建立 Power Automate 流程，以在建立新的費用報告時透過電子郵件傳送費用報告的複本。

## 高階實驗室步驟

下列已識別為必須實作以完成專案的必要項目：

- 提交費用報告時，員工必須收到電子郵件。 

### 必要條件

- 完成**單元 1 實驗室 0 - 驗證實驗室環境**

## 練習 1：建立費用報告通知流程

**目標：** 在此練習中，您將建立可實作需求的 Power Automate 流程。 

### 工作 #1：建立流程

1. 導覽到 `https://make.powerapps.com`

1. 您可能需要重新驗證、選取 [登入]****，然後視需要依照指示操作。

1. 選取右上方的 [Dev One]**** 環境 (若尚未選取)。

1. 在左側導覽中，選取 [流程]****。

1. 如果出現提示，請選取 [開始]****。

1. 選取 [新增流程]****，然後選取 [自動化雲端流程]****。

1. 針對**流程名稱**，輸入 `Expense Notification`。

1. 在 [選擇流程的觸發程序]**** 中，搜尋 Dataverse

1. 選擇觸發程序 [當新增、修改或刪除資料列時]****，然後選取 [建立]****。

1. 填入流程的觸發條件：

    1. 為 [變更類型]**** 選取 [已新增]****
    
    1. 為 [資料表名稱]**** 選取 [費用報告]****

    1. 針對 [範圍] **** 選取 [組織]****

    1. 選取觸發程序步驟上的省略符號 ( [...])****，然後選取 [重新命名]****。 重新命名觸發程式步驟 `When an Expense Report is added` 

這是個很好的做法，讓您和其他流程編輯者均可了解步驟的目的，而不必深入探討細節。

### 工作 2：建立取得費用報告資料列的步驟

1. 選取 **+ 新步驟**。 此步驟會擷取費用報告資訊，包括電子郵件地址。

1. 搜尋 Dataverse

1. 選取**依識別碼取得資料列**動作。

1. 選取 [使用者]**** 作為 [資料表名稱]****

1. 選取 [資料列識別碼]**** 欄位。 請注意，會出現視窗提示您選取 [Dynamic 內容]**** 或 [運算式]****。

1. 在 [資料列識別碼]**** 欄位中，從 [動態內容]**** 清單中選取 [擁有者 (值)]****。 在此步驟中，您會查閱 [費用報告] 資料列的擁有者，而此資料列是為了觸發此流程而建立的。 

1. 在 [取得資料列 ID] **** 動作中選取觸發程序步驟上的省略符號 ( [...])****，然後選取 [重新命名]****。 將此動作重新命名為 [取得擁有者客]

這是個很好的做法，讓您和其他流程編輯者均可了解步驟的目的，而不必深入探討細節。

### 工作 #3：建立傳送電子郵件以確認提交費用報告的步驟

1. 選取 **+ 新步驟**。 此步驟會將電子郵件傳送給提交費用報告的個人。

1. 搜尋郵件，然後從 [Office 365 Outlook]**** 連接器選取 [傳送電子郵件 (V2)]**** 動作。

1. 如果系統提示您接受使用此動作的條款及條件，請選取 [接受]****。

1. 選取 [收件人]**** 欄位，並輸入您的個人電子郵件地址。 (我們有許多方式可以動態填入電子郵件地址，但針對此練習，我們將手動指派電子郵件地址。)  

1. 在 [主旨]**** 欄位中，輸入 `Your expense report was submitted`

1. 在 [電子郵件本文] **** 輸入下列文字：

名稱括以括號的欄位，必須置入動態內容。 建議您先複製並貼上所有文字，然後在正確的位置新增動態內容。

    Dear {First Name},
    
    Thank you for submitting your expense report for the total amount of {Report Total Amount} with a due date of {Report Due Date}.
    
     
    Best regards,
    Campus Administration
    Bellows College

1. 醒目提示 **{First Name}** 文字。 將其取代為 [取得擁有者]**** 步驟中的 [名字]**** 欄位。

1. 醒目提示 **{Report Total Amount}** 文字。 將它取代為 **[新增費用報表時] 字段的** [總金額**] 字段**。

1. 醒目提示 **{Report Due Date}** 文字。 將它取代為 **[新增費用報表**時] 步驟中的 **[報表到期日]** 字段。

1. 選取**儲存**。

保持流程索引標籤開啟，以供下一個工作使用。 您的流程看起來應該像下面這樣：

![剛建立流程的螢幕擷取畫面](media/lab-4-create-an-automated-solution-01.png)

### 工作 4：驗證並測試流程

1. 在瀏覽器中開啟新索引標籤，然後瀏覽至 https://make.powerapps.com。

1. 選取右上方的 [Dev One]**** 環境 (若尚未選取)。

1. 選取 [應用程式]****，然後開啟 [費用追蹤器應用程式]****。

1. 保持此瀏覽器索引標籤處於開啟狀態，然後導覽回之前的流程索引標籤。

1. 在命令列上，選取 [測試]****。 選取 [手動]**** 然後選取 [測試]****。

1. 保持模型驅動應用程式開啟，並巡覽至瀏覽器索引標籤。

1. 使用左側的網站地圖導覽，選取 [費用報告]****。

1. 選取 [+ 新增]**** 按鈕，以新增 [費用報告]**** 記錄。

1. 完成 [費用報告記錄]****，如下所示：

    - **報告名稱：** 測試報告

    - **報告目的：** 會議

    - **報告到期日：** 明天

1. 選取 [儲存 &amp; 關閉]**** 按鈕。

1. 導覽至流程測試執行的瀏覽器索引標籤。 短暫延遲之後，您應該會看到流程正在執行。 您可以在其中攔截任何流程中的問題，或確認流程已成功執行。

短暫延遲後，您應該會在收件匣中看到電子郵件。 

>**注意：** 其可能會移至您的 [垃圾郵件] 資料夾。
