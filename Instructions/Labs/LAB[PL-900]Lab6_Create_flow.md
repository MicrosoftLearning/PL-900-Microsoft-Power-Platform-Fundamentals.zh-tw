---
lab:
  title: 實驗室 6：建立 Power Automate 流程
  learning path: 'Learning Path: Demonstrate the capabilities of Microsoft Power Automate'
  module: 'Module 2: Build a Microsoft Power Automate flow'
---

## 學習目標

在本練習中，學習者會使用Power Automate中的 Microsoft Copilot 來建立一系列不同的雲端流程。 您將使用不同的建立方法，例如 Copilot 和從頭開始熟悉可用的不同選項。

完成此練習之後，您將：

- 使用自然語言提示來設計工作流程
- 設定觸發程式和動作
- 測試自動化以實際使用。

### 案例

Contoso 諮詢是一個專業服務組織，專門從事 IT 和 AI 諮詢服務。 全年，他們為客戶提供許多不同的活動。 其中一些是貿易展示風格活動，他們有許多合作夥伴進來，並提供新產品、市場趨勢和服務的詳細數據。 其他則發生在全年，並且是快速網路研討會，用來提供個別產品的詳細數據。 此外，Contoso 開始使用自動化代理程式來協助客戶解決問題。

Contoso 想要使用 Power Automate 建置註冊確認流程，以在客戶註冊事件時傳送自動電子郵件給客戶。 

在本練習中，您將根據特定準則建置一系列 Power Automate 流程。

開始本練習之前，您必須先完成下列實驗室：

- **實驗室 2 – 建立數據模型**
- **實驗室 5 – 建置模型驅動應用程式**

## 練習 1：建立工作階段註冊通知流程

在第一個練習中，您將建置流程，以在建立新的會話註冊時自動執行。 其會取得會話、事件和聯繫人的詳細數據，並透過註冊詳細數據傳送電子郵件給此專案。

### 工作 1：建立流程

我們想要將註冊確認傳送給任何新註冊的使用者。 我們將建立流程，以擷取註冊的詳細數據，並將確認電子郵件傳送給已註冊的使用者。

1. 瀏覽至 [https://make.powerautomate.com](https://make.powerautomate.com/)。

2. 您可能需要重新驗證、選取 [登入]****，然後視需要依照指示操作。

3. 選取右上方的 [Dev One]**** 環境 (若尚未選取)。 （重要，請務必忘記執行此步驟）。

4. 在左側導覽中，選取 [ **建立**]。 （如果出現提示，請選取**** 開始使用。）

5. 選取 [新增流程]****，然後選取 [自動化雲端流程]****。

6. 輸入**流程名稱**的**註冊通知**。

7. 在 [選擇流程的觸發程序]**** 中，搜尋 **Dataverse**。

8. 選擇觸發程序 [當新增、修改或刪除資料列時]****，然後選取 [建立]****。

    如果您看到無效 **的參數** 錯誤，這是因為您尚未通過驗證。 請遵循下列步驟來建立連線。 
    - 選取 [ **變更連線**]。
    - 選取 [新增 *]。*
    - 在 [ **連線名稱]** 欄位中，輸入MOD **系統管理員**。 將 [ **驗證類型** ] 保留為 **[OAuth]**，然後 **選取 [登入**]。
    - 登入之後，請移至 **步驟 9。** 

9. 填入流程的觸發條件：

    - 為 [變更類型]**** 選取 [已新增]****
    - 選取 **[數據表名稱]** 的 **[工作階段註冊]。**
    - 針對 [範圍] 選取 **[組織****] 觸發程式步驟，選取省略號 （**...**）， 然後選取 [**重新命名**]。** 

10. 重新命名觸發程式步驟 **新增工作階段註冊時。**

![新增會話觸發程式設定時的螢幕快照](media/power-automate-01.png)

這是個很好的做法，讓您和其他流程編輯者均可了解步驟的目的，而不必深入探討細節。


### 工作 2：建立步驟以取得註冊所針對之事件會話的詳細數據。

1. 選取 **+ 新步驟**。 

2. 搜尋依 **標識碼**取得數據列。 

3. 選取**依識別碼取得資料列**動作。

4. 選取 **[事件工作階段** ] 作為 **[資料表名稱]**

5. 選取 [資料列識別碼]**** 欄位。 請注意，圖示會顯示為選取 **[動態內容** ] 或 **[表達式**]。

6. 在 [**數據列標識符**] 字段中，從 **[動態內容**] 列表中選取 **[事件會話][值**]。 在此步驟中，您會查閱**建立來觸發此流程之**會話註冊**的事件會話**。

7. 在 [取得資料列 ID] **** 動作中選取觸發程序步驟上的省略符號 ( [...])****，然後選取 [重新命名]****。 重新命名此動作 **取得事件會話**

![取得事件會話動作設定的螢幕快照](media/power-automate-02.png)

接下來，我們將取得會話所進入之事件的詳細數據。

8. 在 [ **取得事件會話** ] 步驟底下，選取 [ **+ 插入動作]。**

9. 搜尋依 **標識碼**取得數據列。 

10. 選取**依識別碼取得資料列**動作。

11. 選取 **[事件** ] 作為 **[資料表名稱]**

12. 選取 [資料列識別碼]**** 欄位。 請注意，圖示會顯示為選取 **[動態內容** ] 或 **[表達式**]。

13. 在 [**數據列標識符**] 字段中，從 **[動態內容**] 列表中選取 **[事件][值**]。 在此步驟中，您會查閱**上**一個步驟中擷取的事件會話**事件**。

14. 在 [取得資料列 ID] **** 動作中選取觸發程序步驟上的省略符號 ( [...])****，然後選取 [重新命名]****。 重新命名此動作 **取得事件。**

![取得事件動作設定的螢幕快照](media/power-automate-03a.png)

最後，我們將取得註冊會話的人員詳細數據。

15. 在 [取得事件詳細數據] 底下，設定 [ **插入新的動作**]。

16. 在搜尋欄位中，輸入 **依標識元**取得數據列。

17. 選取 [ **依標識符**取得數據列]。

18. 選取 [聯絡人]**** 以取得 [資料表名稱]****

19. 選取 [資料列識別碼]**** 欄位。 請注意，會出現視窗提示您選取 [Dynamic 內容]**** 或 [運算式]****。

20. 在 [**數據列標識符**] 欄位中，從 [**動態內容 **] 清單中選取 **[工作階段註冊時**] 觸發**程式中的 [參與者][值]** 字段。

21. 選取 [**依標識符**取得數據列] 文字，然後重新命名此動作 **[取得****參與者詳細數據**]。

![取得參與者詳細數據動作設定的螢幕快照](media/power-automate-04a.png)

### 工作 3：建立步驟以傳送電子郵件以確認會話註冊

1. 在 [ **取得參與者詳細數據] 步驟底下** ，選取 [ **插入新的動作**]。

2. 在搜尋欄位中，輸入 **[傳送電子郵件**]。

3. 選取 [傳送電子郵件 (第 2 版)]****。

系統可能會提示您建立 Outlook 的連線，如果是，請選取 **[登入**] 按鈕，然後使用 Mod Administrator** 帳戶登入**。 

![建立連線畫面的螢幕快照](media/power-automate-05.png)

4. 就在 [ **到]** 欄位上方，選取 **齒輪** 圖示。 從出現的功能表中，選取 [ **使用動態內容**]。

![使用動態內容的螢幕快照](media/power-automate-06.png) 

5. 使用 [動態值]，在 [**收件者] 字段中，選取 **[取得參與者詳細數據 **] 底下的 **[電子郵件****]。

![將設定為欄位至參與者電子郵件的螢幕快照。](media/power-automate-07.png)

6. 在 [ **主旨]** 欄位中，確定其顯示 [註冊確認]。

7. 在 [電子郵件本文] **** 輸入下列文字：

> **注意：** 動態內容必須放在方括弧中命名字段的位置。 建議您先複製並貼上所有文字，然後在正確的位置新增動態內容。

  *親愛的 {名字}，感謝您在 {事件日期} 上註冊我們即將推出的會話 {會話名稱}。{Speaker} 將會在此研討會中成為您的演講者。您的會話已排定為最後 {Duration （Hours）}。請查看 {Event Name} 的其他會話。*

  *此致敬意*

  *事件管理*
  
  *Contoso 諮詢*

接下來，我們將以下面所述的專案取代括弧中的文字。

8. 醒目提示 **{First Name}** 文字。 將它取代為 [取得參與者詳細數據] 步驟中的 **[**名字**]** 字段。

9. 反白顯示 **{會話名稱}** 文字。 將它取代為 **[取得事件會話] 步驟中的 **[會話**名稱**] 字段。

10. 反白顯示 **{Event Date}** 文字。 將它取代為 **[取得事件詳細**數據] 步驟中的 **[事件日期]** 字段。

11. 反白顯示 **{Speaker}** 文字。 將它取代為 **[取得事件會話 **] 步驟的 **[演講者][值]** 字段。

12. 反白顯示 **{Duration （Hours）}** 文字。 將它取代為 **[取得事件會話 **] 步驟中的 **[持續時間（時數）**] 字段。

13. 反白顯示 **{事件名稱}** 文字。 將它取代為 **[取得事件詳細**數據] 步驟中的 **[事件名稱**] 字段。

您已完成的步驟應該類似映像：

![已完成電子郵件的螢幕快照](media/power-automate-08.png)

14. 選取**儲存**。

保持流程索引標籤開啟，以供下一個工作使用。 您的流程看起來應該像下面這樣：

### 工作 4：輸入一些範例數據

> **注意：** 如果您已完成實驗室 5 – 建置模型驅動應用程式，您可以略過這項工作並直接移至工作 5。 

1. 使用左側的導覽，選取 [應用程式]。

2. 將顯示的應用程式從 **[我的應用程式** ] 變更為 **[全部**]。

3. 將滑鼠停留在 **[事件管理** ] 應用程式上，然後選取 [ **播放** ] 圖示。

4. 使用左側導覽，選取 [ **聯繫人**]。

5. 在命令行上，選取 [ **+ 新增** ] 按鈕。

6. 在 [ **新增聯繫人]** 畫面中，設定如下：

    - **名字：** 蘇珊娜

    - **姓氏：** 迪亞茲

    - **職稱：** 工程師

7. 在窗體標頭中，選取 [聯繫人類型] 旁的 **向下箭號**。

8. 將 [ **聯繫人類型** ] 設定為 **[說話者**]。

![顯示如何在表單上設定 [聯繫人類型] 欄位的螢幕快照。](media/power-automate-09.png)

9. 選取 [ **儲存** ] 按鈕以儲存聯繫人，並將它保持開啟。

10. 選取 [**+ 新增**] 按鈕。

11. 在 [ **新增聯繫人]** 畫面中，設定如下：

    - **名字：** 埃德加

    - **姓氏：** 斯文森

    - **職稱：** 架構師

    - **電子郵件：** 輸入您的電子郵件位址（重要或您的流程不會執行）

12. 在窗體標頭中，選取 [聯繫人類型] 旁的 **向下箭號**。

13. 將 [ **聯繫人類型** ] 設定為 **[參與者**]。

14. 選取 [儲存 &amp; 關閉]**** 按鈕。

接下來，我們將新增事件。

15. 使用左側導覽，選取 **[事件**]。

16. 在命令行上，選取 [ **+ 新增** ] 按鈕。

17. 在 [ **新增事件** ] 畫面中，設定如下：

    - **活動名稱：** 春季會議。

    - **事件日期：** 明天的日期。

    - **最大出席者：** 500

    - **活動詳細數據：** 春季會議，展示我們支援廠商的最新產品和服務。

    - **事件類型：** 會議

    - **位置：** 西雅圖

    - **註冊必要：** 是/True

![已完成事件表單的螢幕快照。 ](media/power-automate-10.png)

18. 選取 [儲存 &amp; 關閉]**** 按鈕。

接下來，我們將新增事件的新會話。

19. 使用左側導覽，選取 **[事件會話**]。

20. 選取 [**+ 新增**] 按鈕。

21. 設定 **事件會話** ，如下所示：

    - **會話名稱：** 負責任的 AI

    - **會話日期：** 明天的日期

    - **持續時間：** 1.5 小時

    - **會話描述：** 使用所有新的 AI 解決方案，負責很重要。 我們將討論挑戰。

    - **演講者：** Suzanne Diaz

    - **活動：** 春季會議

![已完成事件會話表單的螢幕快照。 ](media/power-automate-11.png)

22. 選取**儲存後關閉**按鈕。

 
### 工作 5：驗證和測試流程

1. 如有必要，請在瀏覽器開啟新的索引標籤，並瀏覽至 [https://make.powerapps.com](https://make.powerapps.com/)。 

2. 選取右上方的 [Dev One]**** 環境 (若尚未選取)。

3. 選取 **[應用程式** ]，然後開啟 **Contoso 事件管理應用程式**。

4. 保持此瀏覽器索引標籤處於開啟狀態，然後導覽回之前的流程索引標籤。

5. 在命令列上，選取 [測試]****。 選取 [手動]**** 然後選取 [測試]****。

6. 保持模型驅動應用程式開啟，並巡覽至瀏覽器索引標籤。

最後，我們將建立 **會話註冊**。

7. 使用左側導覽，選取 [ **會話註冊]。**

8. 在命令行上 **，選取 **[+ 新增**]。**

9. 完成工作階段註冊，如下所示：

    - **名稱：** E、Swenson 註冊。

    - **註冊日期：** 今日日期

    - **參與者：** 埃德加·斯文森

    - **研討會：** 負責任的 AI

![已完成工作階段註冊表單的螢幕快照。 ](media/power-automate-12.png)

10. 選取 [儲存後關閉]**** 按鈕。

11. 選取 [儲存 &amp; 關閉]**** 按鈕。

12. 導覽至流程測試執行的瀏覽器索引標籤。 短暫延遲之後，您應該會看到流程正在執行。 您可以在其中攔截任何流程中的問題，或確認流程已成功執行。

短暫延遲後，您應該會在收件匣中看到電子郵件。

> **注意：** 其可能會移至您的 [垃圾郵件] 資料夾。
