---
lab:
  title: 實驗室 3：如何建置模型導向應用程式
  module: 'Module 3: Get started with Power Apps'
---

# 實驗室 3：如何建置模型導向應用程式

**WWL 租使用者 - 使用規定** 如果您要將租使用者作為講師導向訓練傳遞的一部分提供，請注意，租使用者是為了在講師導向訓練中支援實際操作實驗室。 在實際操作實驗室之外，不應共用或使用租使用者。 本課程中使用的租使用者是試用租使用者，無法在類別超過且不符合延伸模組資格之後使用或存取。 租使用者不得轉換成付費訂用帳戶。 在此課程中取得的租使用者會保留 Microsoft Corporation 的 屬性，我們隨時保留取得存取權和存放庫的權利。 

## 案例

Bellows College 是一個教育組織，校園內有多棟大樓。 校園訪客目前記錄在紙本日誌中。 此資訊並未以一致的方式擷取，而且也無法收集和分析整個校園造訪情形的相關資料。

校園行政單位想要更新其訪客登記系統，讓保全人員控管各棟大樓的出入狀況，且所有造訪情形都必須由大樓負責人預先登記和記錄。

在整個課程中，您將建立應用程式並執行自動化功能，以便 Bellows College 的行政和保全人員能夠管理及控管校內大樓的出入狀況。

在此實驗室中，您將建立 Power Apps 模型導向驅動程式，可讓後端辦公室校園教職員管理整個校園中的造訪情形記錄。

高階實驗室步驟

在建立模型導向應用程式的過程中，您將完成下列工作：

- 建立名稱為 Bellows Campus Management 的新模型導向應用程式

- 編輯應用程式導覽以參考必要的資料表

- 自訂應用程式必要資料表的表單和檢視

我們將使用下列元件：

- **檢視**：「檢視」可讓使用者在表單資料表中顯示現有資料。

- **表單**：使用者可於此處建立/更新資料表中的新資料列。

兩者均會整合至模型導向應用程式，以提供更優質的使用者體驗。

必要條件

- 完成**單元 0 實驗室 0：驗證實驗室環境**

- 完成**課程模組 2 實驗室 1 - 資料模型化**

開始前要考慮的事項

- 我們應該進行哪些變更以提升使用者體驗？

- 根據我們已建立的資料模型，應該在模型導向應用程式中包含哪些項目？

- 在模型導向應用程式的網站地圖上，我們可以完成哪些自訂項目？

練習 1：自訂檢視和表單

**目標：** 在此練習中，您將針對要在模型導向應用程式中使用的自訂建立資料表自訂檢視和表單。

工作 #1：編輯「造訪情形」表單

1.  若還未登入，請先登入 <https://make.powerapps.com> 。

2.  如果尚未選取，請在右上方選取您的 [[我的縮寫名] 練習] 環境。

3.  使用左側導覽，選取 [ **資料表**]，然後開啟您的 **[流覽** ] 資料表。

    如果您沒看到 [造訪情形] 資料表，請確保您處在正確的環境中 (步驟 2)。

4.  在 [**資料體驗] 區**段下，選取 [**表單**]，然後開啟 [具有**主要**表單類型**的資訊**] 表單。  (**重要事項：** 請務必選取表單類型為 **Main**.)  

    **重要事項：** 由於所有表單的名稱皆預設為「資訊」，因此請務必確認您選取的表單具有 [主要] 表單類型，而不是其他類型。 依預設，表單具有兩個欄位：[名稱] 和 [擁有者]。

5.  在畫面右側的 [ **屬性** ] 面板上，選取 [ **顯示名稱** ] 欄位，並將其變更為 `Main Information`

6.  從左側流覽窗格中選取 **[資料表** 資料行]，然後將資料行拖曳至表單或直接按一下資料行名稱，在 [ **擁有者** ] 欄位下方新增下欄欄位：

    1. **訪客**

    2. **排定的開始時間**

    3. **排定的結束時間**

    4. **實際開始**

    5. **實際結束**

7.  拖曳 **[代碼]** 資料行，然後將其拖放至表單標頭。

    標頭為表單的右上方區域。 您可能需要摺疊畫面右側的 [屬性] 面板，才能看到表單上的欄位。

8.  仍選取 [代碼] 欄位時，在畫面右側 [屬性] 面板中勾選 [唯讀] 的核取方塊。

9.  選取 **[擁有者]** 欄位。 在 [屬性] 面板中，將 [ **標籤** ] 變更為 `Host`

10. 選取右上方的 [ **儲存併發布** ] 按鈕，然後等候儲存和發佈完成。

11. 如果在新的瀏覽器索引標籤或視窗中開啟 [編輯] 檢視，請關閉它。 否則，請選取 🡠 畫面左上方的 **[返回** ]。 您現在應該回到 **Visit** table Forms。

12. 使用左上方 (**表格**  >  中的階層連結**流覽**  >  **表單**) 。 選取 **[流覽]** 以返回 **[流覽** 表] 屬性畫面。 


工作 2：編輯 [現行造訪情形] 檢視

在此工作中，我們將修改預設的 [現行造訪情形] 檢視，並為今天的造訪情形建立新的檢視。

1.  在 [ **資料體驗] 區** 段下，選取 [ **檢視** ]，然後開啟您的 **[作用中流覽]** 檢視。

2.  按一下或拖放下列欄位，將欄位新增至檢視：

    1. **程式碼**

    2. **訪客**

    3. **排定的開始時間**

    4. **排定的結束時間**

3.  選取 [ **建立于]** 資料行上的下拉式功能表，然後選取 [ **移除**]。 [ **建立日期** ] 欄位現在將會從檢視中移除。

4.  調整個別資料行寬度的大小，以符合資料。

5.  在 **[排序依據... ]** 下 選取 X 以移除 **[名稱**]，然後改為選取 **[已排程的開始]。**

6.  選取 **[已排程的開始** ] ，將排序次序變更 **為較舊**。

7.  選取右上方的 [ **儲存併發布** ] 按鈕，並等候發佈完成。


工作 #3：為今天的造訪情形建立新的檢視

接下來我們將複製檢視，並為今天的造訪情形建立新的檢視。

重要事項：請確定您未關閉 [現行造訪情形] 檢視，因為我們會利用其來建立新的今日造訪情形檢視。

1.  選取 [另存新檔]。

2.  將 **[名稱** ] 變更為 `Today’s Visits` ，然後選取 [ **儲存**]。

3.  在 [屬性] 面板中，選取 **[編輯篩選**]。

4.  選取 **[+ 新增**]，選取 **[新增資料列**]。

5.  選取 **[排程的開始**] 欄位，然後將 [**等於****今天**] 變更為下拉式清單中的條件。

6.  選取 **...** [**狀態**] 資料列上的**更多命令**，然後選取 [**刪除**] 以刪除該篩選準則。

7.  選取 **[確定** ] 以儲存條件。 檢視現在會篩選為只顯示目前 **排程開始日期** 的記錄。

8.  將 **[實際開始時間]** 和 **[實際結束時間]** 欄位新增至檢視。

    **注意：** 由於我們不再依據檢視狀態進行篩選，因此將會取得今天的所有造訪情形，包括已完成的項目。 這兩個欄位將有助於區分已完成的造訪情形和進行中的造訪情形。

9.  選取右上方的 [ **儲存併發布** ] 按鈕，並等候發佈完成。


練習 2：建立模型驅動應用程式

**目標：** 在此練習中，您將建立模型驅動應用程式、自訂網站地圖，以及測試應用程式。

為了簡單和節省時間起見，有部分 [造訪] 資料行不會在此實驗中處理。

工作 #1：建立應用程式

1.  如果您尚未登入，請登入 <https://make.powerapps.com> 。

2.  如果尚未選取，請在右上方選取您的 **[[我的縮寫名] 練習]** 環境。

3.  選取左側導覽上的 **[+ 建立** ]。

4.  建立模型導向應用程式：

    1. 在 [**建立您的應用程式**] 畫面的 [**開始]** 區段中選取 **[空白應用程式**]。

    2. 在 [根據 Dataverse 的空白應用程式] 底下，選取 [建立]。

    3. 針對 **[名稱]** 輸入 `Bellows Campus Management` ，然後選取 [**建立**]。

5.  載入新的模型驅動應用程式之後，選取 [+ 新增頁面] 按鈕。

6.  在 [ **新增頁面]** 畫面上，選擇 **[Dataverse 資料表**]，然後選取 [ **下一步]** 按鈕。

7.  選取下列資料表：

    1. 瀏覽

    2. Contact

8.  在您擁有這兩個數據表之後，請選取 [ **新增**]。

9.  使用畫面左側的導覽圖示，選取 [導覽]。

10. 在流覽窗格上，選取下方的 [ **新增群組** ]，其中顯示 [流覽]。 您可能需要展開左側的功能表。

11. 在畫面右側的 [ **顯示選項** ] 區段中，將 **Title** 屬性變更為 `Security`

12. 選取 [儲存]，然後等待變更儲存完畢。

13. [儲存] 完成後，請選取 [發佈] 按鈕以發佈變更。


工作 #2：測試應用程式

啟動應用程式

1. 選取 [ **播放]** 按鈕，模型驅動應用程式會在新的索引標籤中載入。

建立新的連絡人

2.  應用程式應開啟至 [我的現行連絡人] 檢視。 如果沒有，請選取左側導覽上的 [ **連絡人** ]。

3.  從命令列選取 **[+ 新增** ]。

4.  輸入 **名字** 做為 `John` ， **並將姓氏** 輸入為 `Doe`

5.  提供您的個人電子郵件做為 **[電子郵件]** 。 這將會用於未來的實驗室，您將在其中收到電子郵件。

6.  選取 [儲存並關閉]。

7.  您現在應該會在 [我的現行連絡人] 檢視中看到已建立的連絡人。

建立新的造訪

8.  從左側導覽 (選取 **[流覽** ]，也稱為 sitemap.) 

9.  選取 [+ 新增]。

10. 如下所示輸入欄位：

    1. **名稱**：`New test visit`

    2. **訪客**：選取 **John Doe**

    3. **排程開始**時間：選取明天的日期和下午 2：00 作為開始時間

    4. **排程結束**：選取明天的日期和下午 3：30 作為結束時間

11. 選取 [儲存並關閉]。 這會建立 [流覽]，您應該能夠在 [ **作用中流覽]** 檢視中看到它。

12. 使用使用中流覽旁的下拉式清單，將檢視變更為**今天****流覽**。 您應該不會再於此檢視中看到新的造訪情形，因為其預定時間為明天。

13. 您可以新增更多測試記錄。

執行中的模型驅動應用程式看起來應該大致如下：

![](media/3-model-driven-app.png)

恭喜！ 您已建立並設定第一個模型驅動的應用程式。

## 挑戰

- 選取 [連絡人] 的特定檢視和表單。

