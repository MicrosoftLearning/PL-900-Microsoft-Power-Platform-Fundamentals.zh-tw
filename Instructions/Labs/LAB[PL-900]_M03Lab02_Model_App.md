---
lab:
  title: 實驗室 3：如何建置模型導向應用程式
  module: 'Module 3: Get started with Power Apps'
---

# 實驗室 3：如何建置模型導向應用程式

**WWL 租用戶 - 使用條款**如果您針對講師導向訓練交付的一部分取得租用戶，請注意，租用戶的功能是為了在講師導向訓練中支援實際操作實驗室。 租用戶不應共用，或用於實際操作實驗室以外的用途。 本課程中使用的租用戶是試用租使用者，在課程結束后無法使用或存取租使用者，且不符合延伸模塊的資格。 租用戶不得轉換成付費訂用帳戶。 此課程中提供的租用戶仍是 Microsoft Corporation 的財產，我們保留隨時取得存取權和重新持有的權利。 

## 案例

貝洛斯學院是一個具有多個校園和課程的教育組織。 許多貝洛學院的講師和系統管理員需要參加活動，並購買專案。 從歷史上看，追蹤這些費用是一個挑戰。

校園管理希望藉由提供員工報告費用的數位方式，將費用報告系統現代化。

在整個課程中，您將建置應用程式和執行自動化，讓Bellows 學院員工能夠管理費用。

## 高階實驗室步驟

在建立模型驅動應用程式時，您將完成下列作業：

- 建立名為 Bellows Expense Management 的新模型驅動應用程式

- 編輯應用程式導覽以參考必要的資料表

- 自訂應用程式所需資料表的表單和檢視

我們將使用下列元件：

- **檢視：** 檢視可讓使用者在表單資料表中顯示現有的資料。

- **表單**：這是使用者在資料表中建立/更新新資料列的位置。

這兩者都會整合至模型驅動應用程式，以提供更好的使用者體驗。

### 必要條件

- 課程模組 1 實驗室 0 完成 **- 驗證實驗室環境**

**開始之前要考慮的事項**

- 我們應該進行哪些變更來改善使用者體驗？

- 我們應該根據我們建置的資料模型，在模型驅動應用程式中納入哪些項目？

- 模型驅動應用程式的網站地圖上可以進行哪些自訂？

## 練習 1：自訂檢視和表單

**目標：** 此練習中，您將自訂將在模型驅動應用程式中使用的自訂已建立資料表的檢視和表單。

### 任務 #1：編輯費用報表表表體

1. 如果您尚未登入，請登入 https://make.powerapps.com

1. **如果尚未選取，請選取右上方的 [開發 One**] 環境。

1. 使用左側導覽，選取 **[數據表**]，然後開啟 **[費用報表]** 數據表。

如果您沒有看到 Expense 報表資料表，請確定您位於正確的環境中 （步驟 2）。

1. 在 [資料體驗]**** 區段下方選取 [表單]****，然後按一下以開啟具有 [主要]**** 表單類型的 [資訊]**** 表單。 (**重要事項：** 請務必選取表單類型為 [主要]**** 的表單。)

    >**重要事項：** 由於所有表單的名稱皆預設為資訊，因此請務必確認您選取的表單具有 [主要] **** 表單類型，而不是其他類型。 依預設，表單具有兩個欄位：[名稱] 和 [擁有者]。

1. 在 [屬性 **] 面板的畫面**右側，選取 [**顯示名稱**] 字段，並將它變更為 [報表資訊]

1. 在左側瀏覽窗格中選取 [資料表資料行]****，然後將資料行拖曳至表單或按一下資料行名稱，以在 [擁有者]**** 欄位的下方新增下列欄位：

    - **說明**

    - **報表用途**

    - **報告到期日**

    - **報表總金額**

1. 拖曳 [ **狀態原因]** 資料行，並將其放在窗體標頭中。

標頭是表單的右上方區域。 您可能需要摺疊畫面右側的 [屬性] 面板，才能看到表單上的欄位。

1. 選取 [擁有者]**** 欄位。 在 [屬性] 面板中，將 [ **卷標** ] 變更為 [要求者]

1. 選取右上方的 [儲存並發佈]**** 按鈕，並等候儲存和發佈完成。

1. 如果編輯檢視在新的瀏覽器索引標籤或視窗中開啟，請予以關閉。 否則，請選取 **🡠 畫面左上方的 [返回** ]。 您現在應該回到 **費用報表** 數據表表表體。

1. 使用左上方的階層連結（**數據表** > **費用報表** > **表表表）。** 選取 **[費用報表** ] 以返回 **[費用報表** 數據表屬性] 畫面。

## 任務 #2：編輯作用中費用報表檢視

在這項工作中，我們將修改預設的 [作用中費用報表] 檢視，並針對目前到期的費用報表建立新的檢視。

1. 在 [ **數據體驗] 區段底下** ，選取 [ **檢視** ]，然後開啟 [ **作用中費用報表** ] 檢視。

1. 按一下或拖放欄位，將下欄欄位新增至檢視：

    - **報表用途**

    - **報告到期日**

    - **報表總計**

1. 選取 [建立於]**** 資料行上的下拉式功能表，然後選取 [移除]****。 [建立於]**** 欄位現在會從檢視中移除。

1. 將個別資料行寬度調整為適合資料的大小。

1. 在 [排序依據... ] **** 下 選取 X 以移除 **[名稱** ]，然後改為選取 [ **報表總金額**]。

1. 選取 [ **報表總金額]** ，將排序順序變更為 [較大] 變更為 **[較小**]。

1. 選取右上方的 [儲存並發佈]**** 按鈕，並等候發佈完成。

### 工作 #3：為今天到期的報表建立新檢視

現在，我們將複製檢視，為報表建立新的檢視，因為報表將於今天到期。

>    **重要事項：** 請確定您未關閉 [作用中費用報表] 檢視，因為我們將利用它來建立 [報表今天到期] 檢視。

1. 選取**另存新檔**。

1. 將 [名稱 **] 變更為 [** 立即到期的費用報表]，然後選取 [**儲存**]。

1. 在 [屬性] 面板選取 [編輯篩選條件]****。

1. 選取 [+ 新增]****，選取 [新增資料列]****。

1. 選取 **[報告到期日**] 字段，然後將 [等於今天****]** 變更**為下拉式清單中的條件。

1. 選取 **…** [狀態]**** 列上的 [更多指令]****，然後按一下 [刪除]**** 以刪除該篩選條件。

1. 選取 [確定] **** 以儲存條件。 檢視現在會篩選為只顯示報表到期日**為今天的記錄**。

1. 將 **[報銷金額]** 欄位新增至檢視。

1. 選取右上方的 [儲存並發佈]**** 按鈕，並等候發佈完成。

## 練習 2：建立模型驅動應用程式

**目標：** 在此練習中，您將建立模型驅動應用程式、自訂網站地圖，以及測試應用程式。

為了簡單起見和時間，我們不會處理此實驗室中的所有費用報表數據行。

### 工作 #1：建立應用程式

1. 如果您尚未登入，請登入 https://make.powerapps.com

1. **如果尚未選取，請選取右上方的 Dev One** 環境。

1. 選取位於左側瀏覽上的 [+ 建立]****。

1. 建立模型導向應用程式：

    - 在 [建立您的應用程式]**** 畫面的 [起始]**** 區段中，選取 [空白應用程式]****。

    - 在 [根據 Dataverse 的空白應用程式]**** 底下，選取 [建立]****。

    - 針對 [名稱 **] 輸入 [員工費用管理]**，然後選取 [**建立**]。

1. 載入新的模型驅動應用程式之後，選取 [+ 新增頁面]**** 按鈕。

1. 在 [新增頁面]**** 畫面上，選擇 [Dataverse 資料表]****，然後選取 [下一步]**** 按鈕。

1. 選取下列資料表：

    - 費用報表

    - 連絡人

1. 在您擁有這兩個資料表之後，請選取 [新增]****。

1. 使用畫面左側的導覽圖示，選取 [導覽]****。

1. 在瀏覽窗格中，選取顯示瀏覽的 [新群組]****。 您可能需要展開左側的功能表。

1. 在畫面右側的 **[顯示選項** ] 區段中，將 **Title** 屬性變更為 [報表]

1. 選取 [儲存]****，然後等待變更儲存完畢。

1. [儲存]**** 完成後，請選取 [發佈]**** 按鈕以發佈變更。 等候發佈完成。

## 工作 #2：測試應用程式

**啟動應用程式**

1. 選取 [播放]**** 按鈕，模型驅動的應用程式將會載入新索引標籤。

**建立新的聯繫人**

1. 應用程式應開啟至 [我的現行連絡人]**** 檢視。 如果沒有，請選取 **左側導覽上的 [聯繫人** ]。

1. 從命令列選取 [+ 新的]****。

1. 輸入 **名字** 做為John， **並將姓氏** 輸入為 Doe

1. 以 [電子郵件]**** 的形式提供您的個人電子郵件。 這會在未來的實驗室中使用，您將在其中收到電子郵件。

1. 選取**儲存&amp;關閉**。

1. 您現在應該會在 [我的現行連絡人]**** 檢視中看到已建立的連絡人。

**建立新的費用報表**

1. 從左側導覽中選取 **[費用報表** ]（也稱為 sitemap。）

1. 選取 **+ 新增**。

1. 如下所示輸入至欄位：

    - **報表名稱**：新的測試報表

    - **報告用途**：選取 **會議**

    - **報告到期日**：選取 [今日日期]

1. 選取**儲存後關閉**。 這會建立新的測試報表，您應該能夠在 [ **作用中費用報表** ] 檢視中看到它。

1. 使用 [使用中費用報表] 旁**的下拉式清單，將檢視變更為 **[費用今日**到期]** 。 

1. 您可以新增更多測試記錄。

執行中的模型驅動應用程式看起來應該大致如下：

![剛建立模型驅動應用程式的螢幕快照。](media/lab-3-create-a-model-app-01.png)

恭喜！ 您已建立並設定第一個模型驅動的應用程式。
