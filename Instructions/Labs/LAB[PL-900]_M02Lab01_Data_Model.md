---
lab:
    title: '實驗室 1：資料模型'
    module: '單元 2：Microsoft Dataverse 簡介'
---

# 單元 2：Microsoft Dataverse 簡介

# 案例

Bellows College 是一個教育組織，校園內有多棟大樓。校園訪客造訪情況目前記錄在紙本日誌中。此資訊並未以一致的方式擷取，而且也無法收集和分析整個校園造訪情形的相關資料。 

校園行政單位想要更新其訪客登記系統，讓保全人員控管各棟大樓的出入狀況，且所有造訪情形都必須由大樓負責人預先登記和記錄。

在整個課程中，您將建立應用程式並執行自動化功能，以便 Bellows College 的行政和保全人員能夠管理及控管校內大樓的出入狀況。 

在此實驗室中，您將存取自己的環境、建立 Microsoft Dataverse 資料庫，以及建立可追蹤變更的解決方案。此外，您也會建立資料模型以支援下列需求：

-   R1：追蹤校園造訪情形的位置 (大樓)
-   R2：記錄基本資訊以識別並追蹤訪客 
-   R3：排定、記錄及管理造訪情形 

最後，您會將範例資料匯入至 Microsoft Dataverse。

# 高階實驗室步驟

為準備您的學習環境，您必須：

* 建立解決方案和發佈者
* 新增所需的新元件和現有元件，以符合應用程式需求。如需中繼資料描述 (資料表和關聯性)，請參閱[資料模型文件](https://github.com/MicrosoftLearning/PL-900-Microsoft-Power-Platform-Fundamentals/blob/master/Allfiles/Campus%20Management.png)。您可以按住 CTRL 並在連結上按一下滑鼠左鍵，或在連結上按一下滑鼠右鍵，以在新視窗中開啟資料模型文件。

完成所有自訂項目後，您的解決方案將包含數個資料表：

-   連絡人
-   大樓
-   造訪情形

## 先決條件：

* 完成**單元 0 實驗室 0：驗證實驗室環境**

## 開始前要考慮的事項：

* 命名慣例

* 資料類型、限制 (例如名稱長度上限)

* 日期時間格式化以支援簡易當地語系化

# 練習 1：建立解決方案

## 工作 1：建立解決方案和發佈者

1.  建立解決方案

    -   導覽至 <https://make.powerapps.com>。您可能需要重新驗證：如有需要，請按一下 **[登入]**，然後依照指示操作。

    -   在畫面右上角按一下 **[環境]** 以選取環境，然後從下拉式功能表中選擇環境。

    -   從左側功能表中選取 **[解決方案]**，然後按一下 **[新增解決方案]**。

    -   輸入 **[[您的姓氏] 校園管理]** 做為 **[顯示名稱]**。

2.  建立發佈者

    -   在 [**發佈者**] 區段，選取 [**+ 發佈者**]

    -   在快顯視窗中，輸入 **[Bellows College]** 做為 **[顯示名稱]** 

    -   輸入 **[BellowsCollege]** 做為 **[名稱]**。
    
    -   輸入 **bc** 做為**前置詞**

    -   按一下**儲存**
    
    -   在快顯視窗中按一下 **[完成]**。

3.  完成解決方案建立作業。

    -   接下來，按一下 **[發佈者]** 下拉式清單，然後選取您剛才建立的 **[Bellows College]**
        發佈者。

    -   驗證**版本**是否設為 **1.0.0.0** 
    
    -   按一下 **[建立]**。

# 練習 2：新增現有資料表和建立新資料表

**目標：** 在此練習中，您將新增標準「連絡人」資料表，並針對解決方案中的「大樓」和「造訪情形」建立新的自訂資料表。 

## 工作 1：新增現有資料表

1.  按一下以開啟您剛才建立的 **[校園管理]** 解決方案。

2.  按一下 **[新增現有資料表]** 並選取 **[資料表]**。

3.  找到 **[連絡人]** 並加以選取。

4.  按 **[下一步]**。

5.  按一下 [連絡人] 底下的 **[選取元件]**。

6.  選取 **[檢視]** 索引標籤，然後選取 **[現行連絡人]** 檢視。按一下
    **[新增]**。
    
7.  再按一下 **[選取元件]**。

8.  選取 **[表單]** 索引標籤，然後選取 **[連絡人]** 表單。
    
9.  按一下 **[新增]**。

    > 您應該選取 **1 個檢視**和**1 個表單**。 
    
10.  再按一下 **[新增]**。此動作會將具有選定「檢視」和「表單」的「連絡人」資料表新增至新建立的解決方案。

> 您的解決方案現在應有一個資料表：連絡人。
    
## 工作 2：建立「大樓」資料表

1.  您仍應針對 [校園管理] 解決方案開啟瀏覽器。如果沒有，請依照下列步驟開啟 [校園管理] 解決方案：

    * 登入 <https://make.powerapps.com> (如果您尚未登入)
    
    * 選取 **[解決方案]**，然後按一下以開啟您剛才建立的 **[(您的姓氏) 校園管理]**
          解決方案。
          
2.  建立「大樓」資料表

    -   按一下 **[新增項目]** 並選取 **[資料表]**。
    
    -   輸入 **[大樓]** 做為 **[顯示名稱]** 
    
    -   按一下 **[儲存]**。此動作會開始在背景佈建資料表，同時您也可以開始新增其他資料表和資料行。

## 工作 3：建立「造訪情形」資料表和資料行

此**造訪情形**資料表將包含校園造訪情形的相關資訊，包括大樓、訪客、每個造訪情形的預定時間和實際時間。 

我們想要在造訪簽入程序期間、當系統要求時，為每個造訪情形指派可讓訪客輕鬆輸入和理解的唯一號碼。

> 我們使用**不受時區影響**的行為來記錄日期和時間資訊，因為造訪時間一律使用大樓所在位置的當地時間，且從其他時區檢視時也不應變更。 

1.  您仍應針對 [校園管理] 解決方案開啟瀏覽器。如果沒有，請依照下列步驟開啟 [校園管理] 解決方案：

    * 登入 <https://make.powerapps.com> (如果您尚未登入)
    
    * 選取 **[解決方案]**，然後按一下以開啟您剛才建立的 **[(您的姓氏) 校園管理]**
          解決方案。

2. 建立 [造訪情形] 資料表

   * 按一下 **[新增項目]** 並選取 **[資料表]**。
   
   * 輸入 **[造訪情形]** 做為 **[顯示名稱]** 
   
   * 按一下 **[儲存]**。此動作會開始在背景佈建資料表，同時您也可以開始新增其他資料行。

3. 建立「預定開始時間」資料行

   * 選取 **[造訪情形]** 資料表

   * 請務必選取 **[資料行]** 索引標籤，然後按一下 **[新增資料行]**。
   
   * 輸入 **[預定開始時間]** 做為 **[顯示名稱]**。
   
   * 選取 **[日期和時間]** 做為 **[資料類型]**。
   
   * 在 **[必要項目]** 中，選取 **[必要]**。
   
   * 展開 **[進階選項]** 區段。
   
   * 在 **[行為]** 中，選取 **[不受時區影響]**。
   
   * 按一下 **[完成]**。

4.  建立「預定結束時間」資料行

    * 按一下 **[新增資料行]**。
    
    * 輸入 **[預定結束時間]** 做為 **[顯示名稱]**。
    
    * 選取 **[日期和時間]** 做為 **[資料類型]**。
    
    * 在 **[必要項目]** 中，選取 **[必要]**。
    
    * 展開 **[進階選項]** 區段。
    
    * 在 **[行為]** 中，選取 **[不受時區影響]**。
    
    * 按一下 **[完成]**。
    
5.  建立「實際開始時間」資料行

    * 按一下 **[新增資料行]**。
    
    * 輸入 **[實際開始時間]** 做為 **[顯示名稱]**。
    
    * 選取 **[日期和時間]** 做為 **[資料類型]**。
    
    * 在 **[必要項目]** 中，將此項保留為 **[選用]**。
    
    * 展開 **[進階選項]** 區段。
    
    * 在 **[行為]** 中，選取 **[不受時區影響]**。
    
    * 按一下 **[完成]**。
    
6.  建立「實際結束時間」資料行

    * 按一下 **[新增資料行]**。
    
    * 輸入 **[實際結束時間]** 做為 **[顯示名稱]**。
    
    * 選取 **[日期和時間]** 做為 **[資料類型]**。
    
    * 在 **[必要項目]** 中，將此項保留為 **[選用]**。
    
    * 展開 **[進階選項]** 區段。
    
    * 在 **[行為]** 中，選取 **[不受時區影響]**。
    
    * 按一下 **[完成]**。
    
7.  建立「代碼」資料行

    * 按一下 **[新增資料行]**。
    
    * 輸入 **[代碼]** 做為 **[顯示名稱]**。
    
    * 選取 **[自動編號]** 做為 **[資料類型]**。
    
    * 選取 **[日期前置編號]** 做為 **[自動編碼類型]**。
    
    * 按一下 **[完成]**。
    
8.  按一下 **[儲存資料表]**

# 練習 3：建立關聯性

**目標：** 在此練習中，您將新增資料表之間的關聯性。

## 工作 1：建立關聯性

1.  確認您仍在檢視 **[校園管理]** 解決方案的 **[造訪情形]** 資料表。如果沒有，請導覽至該資料表。

2.  建立「造訪情形」與「連絡人」的關聯性

    * 選取 **[關聯性]** 索引標籤。
    
    * 按一下 **[新增關聯性]**，然後選取 **[多對一]**
    
    * 針對 **[相關項目 (一個)]**，選取 **[連絡人]** 
    
    * 輸入 **[訪客]** 做為 **[查詢資料行顯示名稱]** 
    
    * 按一下 **[完成]**。
    
3.  建立「造訪情形」與「大樓」的關聯性

    * 按一下 **[新增關聯性]**，然後選取 **[多對一]**
    
    * 針對 **[相關項目 (一個)]**，選取 **[大樓]** 
    
    * 按一下 **[完成]**。
    
4.  按一下 **[儲存資料表]**。

5.  選取左上角的 **[返回到解決方案]**。

6.  選取 **[發佈所有自訂項目]**。

# 練習 4：匯入資料

**目標：** 在此練習中，您會將範例資料匯入至 Dataverse 資料庫。

## 工作 1：匯入解決方案

在此工作中，您將匯入包含完成資料匯入所需之 Power Automate 流程的解決方案。

1. 您應將 **DataImport_managed.zip** 檔案儲存在桌面上。如果尚未儲存，請下載[資料匯入解決方案](https://github.com/MicrosoftLearning/PL-900-Microsoft-Power-Platform-Fundamentals/blob/master/Allfiles/DataImport_managed.zip?raw=true)。

2. 登入 <https://make.powerapps.com>。

3. 如果尚未選取，請在右上方選取您的 **[[我的縮寫名] 練習]** 環境。

4. 在左側導覽面板中選取 **[解決方案]**。

5. 按一下 **[匯入]**， 然後按一下 **[瀏覽]**。 瀏覽並選取桌面的 **DataImport_managed.zip**，然後按 **[下一步]**。

>   您可能會收到下列訊息：
>
>   缺少相依性。請安裝下列解決方案，再安裝此項目...
>
>   該訊息指出資料模型尚未完成，
>   發佈者前置詞並非 **bc**，或 **「Building」** 和 **「Visits」** 資料表
>   名稱與上述步驟中所列的名稱不同。

6. 按 **[下一步]**。系統應會提示您重新建立連線。 

7. 展開 **[選取連線]** 下拉式清單，然後選取 **[+ 新增連線]**。

8. 新的瀏覽器視窗或索引標籤隨即開啟。在提示連線時，選取 **[建立]**。如果需要完成建立連線，請登入。

9. 關閉目前的索引標籤，現在您已回到之前的 **[匯入解決方案]** 索引標籤。

10. 確定已選取您剛才建立的連線。如果沒有看到您的連線，請按一下 **[重新整理]** 以重新整理連線清單。 

11. 按下 **[匯入]**。

12. 等待匯入完成。

## 工作 2：匯入資料  

1. 開啟 **[資料匯入]** 解決方案。

2. 檢查 **[匯入資料]** 流程的 **[狀態]**。

3. 如果 **[狀態]** 為 **[關閉]**，請選取 **[匯入資料]** 旁邊的 **[...]**，然後選取 **[開啟]**。

   > **重要：** 如果收到錯誤訊息，請確認您建立的資料表和資料行與上述指示相符。

4. 開啟 **[匯入資料]** 元件。新的索引標籤隨即開啟 Power Automate。 

5. 如果出現快顯視窗，請按一下 **[開始使用]**。 

6. 按一下 **[執行]**，然後在出現提示時，按一下 **[執行流程]**。

7. 按一下 **[完成]**。

8. 等待流程執行個體完成該執行。您可以重新整理 **[28 天執行歷程記錄]** 資料表，查看流程的執行時間。 

    > 此流程的目的是要針對未來的實驗室產生範例資料。在下一個工作中，您將確認資料匯入是否成功。 

## 工作 3：確認資料匯入

1. 導覽回之前的 Power Apps 索引標籤。在快顯視窗上按一下 **[完成]**。 

2. 在左側導覽列上選取 **[解決方案]**，然後開啟 **[校園管理]** 解決方案。

2. 按一下以開啟 **[造訪情形]** 資料表，然後選取 **[資料]** 索引標籤。

3. 按一下右上角的 **[現行造訪情形]** 以顯示檢視選取器，然後選取 **[所有資料行]**。此動作會變更用於顯示「造訪情形」資料的檢視。 

    > 如果您因解析度較低而看不到 **[現行造訪情形]**，則應該會在相同位置看到眼睛圖示。

    > 如果匯入成功，您應該會看到造訪情形資料列清單。

4. 按一下 **[大樓]** 資料行中的任何值，確認「大樓」表單在個別視窗中開啟。 

5. 關閉最近啟動的視窗。

6. 按一下 **[訪客]** 資料行 (您可能需要將檢視捲動至右側)，確認 [連絡人] 表單在個別視窗中開啟。

7. 關閉最近啟動的視窗。

# 挑戰

* 您是否考慮在解決方案中使用*預約*活動？這會帶來什麼變更？
* 您可以如何將預定結束時間強制設在預定開始時間之後？ 
* 您可以如何在單次造訪期間新增對多個會議的支援？
* 您可以如何同時針對外部連絡人以及內部教職員成員確保大樓的出入安全？
* 您可以如何使造訪特定大樓需要管理核准？核准程序在資料模型中會發生什麼變更？

