---
lab:
  title: '實驗室 1:資料模型'
  module: 'Module 2: Introduction to Microsoft Dataverse'
---

# 實驗室 1:資料模型

**WWL 租使用者 - 使用規定** 如果您要將租使用者作為講師導向訓練傳遞的一部分提供，請注意，租使用者是為了支援講師導向訓練中的實際操作實驗室。 租使用者不應共用或用於實際操作實驗室以外的用途。 本課程中使用的租使用者是試用租使用者，無法在類別結束且不符合擴充功能資格之後使用或存取。 租使用者不得轉換成付費訂用帳戶。 在此課程中取得的租使用者會保留 Microsoft Corporation 的屬性，我們保留隨時取得存取權和存放庫的權利。 

## 案例

Bellows College 是一個教育組織，校園內有多棟大樓。 校園訪客造訪情況目前記錄在紙本日誌中。 此資訊並未以一致的方式擷取，而且也無法收集和分析整個校園造訪情形的相關資料。

校園行政單位想要更新其訪客登記系統，讓保全人員控管各棟大樓的出入狀況，且所有造訪情形都必須由大樓負責人預先登記和記錄。

在整個課程中，您將建立應用程式並執行自動化功能，以便 Bellows College 的行政和保全人員能夠管理及控管校內大樓的出入狀況。

在此實驗室中，您將建立資料模型以支援下列需求：

- R1 – 追蹤排程的學校造訪資訊。

- R2 – 記錄基本資訊，以識別及追蹤訪客。

- R3 – 排程、記錄和管理造訪。

最後，您會將範例資料匯入至 Microsoft Dataverse。

高階實驗室步驟

為準備您的學習環境，您必須：

- 如需中繼資料描述 (資料表和關聯性)，請參閱[資料模型文件](https://github.com/MicrosoftLearning/PL-900-Microsoft-Power-Platform-Fundamentals/blob/master/Allfiles/Campus%20Management.png)。 您可以按住 ctrl + 左鍵，或在連結上按一下滑鼠右鍵，在新視窗中開啟資料模型檔。
- 建立 [造訪情形] 資料表
- 使用 Excel 試算表匯入造訪情形資料


## 必要條件

- 完成**單元 0 實驗室 0：驗證實驗室環境**

開始前要考慮的事項

- 命名慣例 - 小心地鍵入名稱。

練習 1：建立新資料表

**目標：** 在此練習中，您將會為造訪情形建立新的自訂資料表。

工作 #1：建立流覽資料表和資料行

[造訪情形] 資料表將包含校園造訪情形的相關資訊，包括訪客、每個造訪情形的預定時間和實際時間。

我們想要在造訪簽入程序期間、當系統要求時，為每個造訪情形指派可讓訪客輕鬆輸入和理解的唯一號碼。

1.  如果您尚未登入，請登入 <https://make.powerapps.com> 

1.  從右上方的 [ **環境** ] 功能表中，確定已選取 [ **練習** 環境]。 

1.  使用左側導覽，選取 [ **資料表**]。

1.  選取 **[+ 新增資料表]** ，然後選擇 **[+ 新增資料表**]。 

1.  針對 **[顯示名稱**]，輸入 `Visit`

1.  選取 [儲存]。 

1.  在 [結構描述] 區段下，選取 [資料行]。 

# 建立「預定開始時間」資料行

1.  選取 [+ 新增資料行]。 

1.  針對 **[顯示名稱]** 輸入 `Scheduled Start` 。 

1.  針對 **[資料類型**] 選取 [**日期和時間**]。 

1.  將 **[必要]** 變更為 **[需要商務**]。 

1.  展開 [進階選項]。 

1.  在 [時區調整]中，選取 [不受時區影響]。 

    > **注意：** 我們會使用 **時區獨立** 行為來記錄日期和時間資訊，因為造訪的時間一律是建築物位置的本機位置，而且在從不同時區檢視時不應該變更。 

1.  選取 [儲存]。 

# 建立「預定結束時間」資料行

1.  選取 [+ 新增資料行]。 

1.  針對 **[顯示名稱]** 輸入 `Scheduled End` 。

1.  針對 **[資料類型**] 選取 [**日期和時間**]。

1.  在 [必要項]中，選取 [業務需求]。

1.  展開 [進階選項]。

1.  在 [時區調整]中，選取 [不受時區影響]。

1.  選取 [儲存]。 

# 建立「實際開始時間」資料行

1.  選取 [+ 新增資料行]。 

1.  針對 **[顯示名稱]** 輸入 `Actual Start` 。

1.  選取 [日期和時間] 作為 [資料類型]。

1.  在 **[必要項目]** 中，將此項保留為 **[選用]** 。

1.  展開 [進階選項]。

1.  在 [時區調整]中，選取 [不受時區影響]。 

1.  選取 [儲存]。 

# 建立「實際結束時間」資料行

1.  選取 [+ 新增資料行]。

1.  輸入**實際結束時間**作為 [顯示名稱]。

1.  選取 [日期和時間] 作為 [資料類型]。

1.  在 **[必要項目]** 中，將此項保留為 **[選用]** 。

1.  展開 [進階選項]。

1.  在 [時區調整]中，選取 [不受時區影響]。

1.  選取 [儲存]。

# 建立「代碼」資料行

1.  選取 [+ 新增資料行]。

1.  針對 **[顯示名稱]** 輸入 `Code` 。

1.  選取 [自動編號] 作為 [資料類型]。

1.  選取 **[日期前置編號]** 做為 **[自動編碼類型]** 。

1.  選取 [儲存]。 

# 建立 [訪客] 查詢資料行

1.  選取 [+ 新增資料行]。

1.  針對 **[顯示名稱]** 輸入 `Visitor` 。

1.  選取 [查詢] 作為 [資料類型]。 

1.  選取 [連絡人] 作為 [相關資料表]。 

1.  展開 [進階選項]。 

1.  針對 **[關聯性名稱**] 輸入 `visitor_id` 。 

1.  選取 [儲存]。


練習 2：匯入資料

**目標：** 在此練習中，您會將範例資料匯入至 Dataverse 資料庫。

### 工作 \# 1：將 Excel 檔案載入 OneDrive

1.  您應該將 **Visits.xlsx** 檔案儲存在虛擬機器上的 **C:/LabFiles** 中。 請下載 [Visits.xlsx](https://github.com/MicrosoftLearning/PL-900-Microsoft-Power-Platform-Fundamentals/raw/master/Allfiles/Visits.xlsx) 檔案 (若您尚未下載)。

2.  若尚未登入，請登入 [https://make.powerapps.com](https://make.powerapps.com/)。 

3.  如果尚未選取，請在右上方選取您的 [[我的縮寫名] 練習] 環境。

4.  選取左上角的 [Waffle] 按鈕以變更應用程式，然後選取 **[OneDrive**]。 (OneDrive 設定可能需要一些時間。 當您在畫面上看到 OneDrive 時，請選取 **[您的 OneDrive 已就緒** ]。) 

5.  從頂端功能表選取 [ **上傳** ]，然後選取 [ **檔案**]。

6.  找出並選取 **Visits.xlsx** 檔案，然後選取 [ **開啟**]。

    > **注意：** 此檔案會位於您機器上的 [所有檔案] 資料夾內。


### 工作 \# 2：建立資料流程

1.  如果您尚未登入，請登入 <https://make.powerapps.com> 

2.  從右上方的 [ **環境** ] 功能表中，確定已選取 [ **練習** 環境]。 

3.  使用左側導覽，選取 [ **資料表**]。 

4.  開啟在上一個練習中建立的 **Visit** 資料表。 

5.  使用頂端的功能表，選取 [**匯**  >  **入匯入資料**]。

6.  在 [選擇資料來源] 對話方塊中，選取 [Excel 活頁簿]。

7.  選取 [連結至檔案] 選項。 選取 **[流覽 OneDrive**]。 若出現提示，請使用您的 Microsoft 365 認證登入。 將瀏覽器設定為一律允許快顯視窗。 

8.  選取在上一個工作中上傳至 OneDrive ** 的Visits.xlsx** 檔案。 

9.  選取 [下一步] 。 

10. 在**Power 查詢**  >  [**選擇資料**] 畫面上，檢查 **[流覽**Excel 活頁簿]。 

11. 選取 [下一步] 。 請勿離開此頁面的瀏覽。

12. 選取 [下一步] 。 

13. 在 [ **對應資料表]** 區段的 [ **載入設定**] 下，選取 [ **載入至現有資料表**]。 

14. 在 [ **目的地資料表** ] 下拉式功能表中，選取資料表 **crXXX_Visit** (其中 XXX 是一組隨機字母和數位) 

15. 在 [ **資料行對應]** 區段上，將 [資料行] 對應至其對應的目的地資料行：

    | 目的地資料行  | 來源資料行   |
    |:---------------------|:----------------|
    | crxxx_ActualEnd      | 實際結束時間      |
    | crxxx_ActualStart    | 實際開始時間    |
    | crxxx_Code           | code            |
    | crxxx_Name           | NAME            |
    | crxxx_ScheduledEnd   | 排定結束時間   |
    | crxxx_ScheduledStart | 排定開始時間 |

16. 選取 [下一步] 。 

17. 選取 [手動重新整理]。 

18. 選取 [發佈] 。 

    > **注意：** 將資料匯入資料表可能需要花費數分鐘的時間。 如果出現一些錯誤，請無需擔心，這是正常的情況且不會影響課程的其餘部分。


工作 #3：確認資料匯入

1.  匯入資料之後，請使用畫面左側的導覽來選取 [ **資料表** ]，然後開啟 **[流覽** ] 資料表。

2.  確認您在 [Visit columns and data] (造訪資料行和資料) 區段下看到匯入的資料。

恭喜，您已順利建立了新資料表並匯入資料。

