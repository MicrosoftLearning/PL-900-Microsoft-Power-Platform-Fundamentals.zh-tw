---
lab:
  title: '實驗室 1:資料模型'
  module: 'Module 2: Introduction to Microsoft Dataverse'
---

# 實驗室 1:資料模型

**WWL 租用戶 - 使用條款**如果您針對講師導向訓練交付的一部分取得租用戶，請注意，租用戶的功能是為了在講師導向訓練中支援實際操作實驗室。 租用戶不應共用，或用於實際操作實驗室以外的用途。 本課程中使用的租用戶是試用租用戶，無法在課程結束後使用，且不符合擴充資格。 租用戶不得轉換成付費訂用帳戶。 此課程中提供的租用戶仍是 Microsoft Corporation 的財產，我們保留隨時取得存取權和重新持有的權利。 

## 案例

Bellows College 是一個教育組織，校園內有多棟大樓。 校園訪客造訪情況目前記錄在紙本日誌中。 此資訊並未以一致的方式擷取，而且也無法收集和分析整個校園造訪的相關資料。

校園行政單位想要更新其訪客登記系統，讓保全人員控管各棟大樓的出入狀況，且所有造訪都必須由大樓負責人預先登記和記錄。

在整個課程中，您將建立應用程式並執行自動化功能，以便 Bellows College 的行政和保全人員能夠管理及控管校內大樓的出入狀況。

在此實驗室中，您將建立資料模型以支援下列需求：

- R1 – 追蹤預定的校園造訪資訊。

- R2 – 記錄基本資訊以識別並追蹤訪客。

- R3 – 排定、記錄及管理造訪。

最後，您會將範例資料匯入至 Microsoft Dataverse。

高階實驗室步驟

為準備您的學習環境，您必須：

- 如需中繼資料描述 (資料表和關聯性)，請參閱[資料模型文件](https://github.com/MicrosoftLearning/PL-900-Microsoft-Power-Platform-Fundamentals/blob/master/Allfiles/Campus%20Management.png)。 您可以按住 CTRL + 左鍵或 並在連結上按一下滑鼠右鍵，或在連結上按一下滑鼠右鍵，以在新視窗中開啟資料模型文件。
- 建立 [造訪] 資料表
- 使用 Excel 試算表匯入造訪資料


## 必要條件

- 完成**單元 0 實驗室 0：驗證實驗室環境**

開始前要考慮的事項

- 命名慣例 - 仔細輸入名稱。


# 練習 1：建立新資料表

**目標：** 在此練習中，您將會為造訪建立新的自訂資料表。

## 工作 #1：建立「造訪」資料表和資料行

[造訪]**** 資料表將包含校園造訪的相關資訊，包括訪客、每個造訪的預定時間和實際時間。

我們想要在造訪簽入程序期間、當系統要求時，為每個造訪指派可讓訪客輕鬆輸入和理解的唯一號碼。

1.  若您尚未登入，請登入 `https://make.powerapps.com`

1.  從右上方的 [ **環境]** 功能表單中，確定 **已選取 [開發 One** 環境]。 

1.  使用左側的巡覽功能，選取 [資料表]****。

1.  選取 [+ 新增資料表]****，然後選擇 [設定進階屬性]****。 

1.  針對**顯示名稱**，輸入 `Visit`。

1.  選取 [儲存]****。 

1.  在 [結構描述]**** 區段下，選取 [資料行]****。 


## 建立「預定開始時間」資料行

1.  選取 [+ 新增資料行]****。 

1.  針對**顯示名稱**，輸入 `Scheduled Start`。 

1.  選取 [日期和時間]**** 作為 [資料類型]****。 

1.  將**需求**變更為**業務需求**。 

1.  展開 [進階選項]****。 

1.  在 [時區調整]**** 中，選取 [不受時區影響]****。 

    > **注意：** 我們使用 [不受時區影響]**** 的行為來記錄日期和時間資訊，因為造訪時間一律使用大樓所在位置的當地時間，且從其他時區檢視時也不應變更。 

1.  選取 [儲存]****。 


## 建立「預定結束時間」資料行

1.  選取 [+ 新增資料行]****。 

1.  針對**顯示名稱**，輸入 `Scheduled End`。

1.  選取 [日期和時間]**** 作為 [資料類型]****。

1.  在 [必要項]**** 中，選取 [業務需求]****。

1.  展開 [進階選項]****。

1.  在 [時區調整]**** 中，選取 [不受時區影響]****。

1.  選取 [儲存]****。 


## 建立「實際開始時間」資料行

1.  選取 [+ 新增資料行]****。 

1.  針對**顯示名稱**，輸入 `Actual Start`。

1.  選取 [日期和時間]**** 作為 [資料類型]****。

1.  在 **[必要項目]** 中，將此項保留為 **[選用]** 。

1.  展開 [進階選項]****。

1.  在 [時區調整]**** 中，選取 [不受時區影響]****。 

1.  選取 [儲存]****。 


## 建立「實際結束時間」資料行

1.  選取 [+ 新增資料行]****。

1.  針對**顯示名稱**，輸入 `Actual End`。

1.  選取 [日期和時間]**** 作為 [資料類型]****。

1.  在 **[必要項目]** 中，將此項保留為 **[選用]** 。

1.  展開 [進階選項]****。

1.  在 [時區調整]**** 中，選取 [不受時區影響]****。

1.  選取 [儲存]****。


## 建立「代碼」資料行

1.  選取 [+ 新增資料行]****。

1.  針對**顯示名稱**，輸入 `Code`。

1.  選取 [自動編號]**** 作為 [資料類型]****。

1.  選取 **[日期前置編號]** 做為 **[自動編碼類型]** 。

1.  選取 [儲存]****。 


## 建立 [訪客] 查詢資料行

1.  選取 [+ 新增資料行]****。

1.  針對**顯示名稱**，輸入 `Visitor`。

1.  選取 [查詢]**** > [查詢]**** 作為 [資料類型]****。 

1.  選取 [連絡人]**** 作為 [相關資料表]****。 

1.  展開 [進階選項]****。 

1.  針對**關係名稱**，輸入 `visitor_id`。 

1.  選取 [儲存]****。


# 練習 2：匯入資料

**目標：** 在此練習中，您會將範例資料匯入至 Dataverse 資料庫。

## 工作 \#1：將 Ecel 檔案載入至 OneDrive

1.  您應該將 **Visits.xlsx** 檔案儲存在虛擬機器上的 **C:/LabFiles** 中。 請下載 [Visits.xlsx](https://github.com/MicrosoftLearning/PL-900-Microsoft-Power-Platform-Fundamentals/raw/master/Allfiles/Visits.xlsx) 檔案 (若您尚未下載)。

2.  如果尚未登入，請登入 `https://make.powerapps.com`

3.  **如果尚未選取，請選取右上方的 Dev One** 環境。

4.  選取左上角的應用程式啟動器（Waffle 按鈕），以變更應用程式，然後選取 **[OneDrive**]。 (OneDrive 設定可能需要一些時間。 在畫面上看到 [您的 OneDrive 已就緒]**** 時，請加以選取。)

5.  從上方功能表選取 [+ 建立]****，然後選取 [檔案]****。

6.  找出並選取 **Visits.xlsx** 檔案，然後選取 [開啟]****。

    > **注意：** 檔案應該位於虛擬機器 [桌面]**** >  [所有檔案]**** 資料夾中。


## 工作 \#2：建立資料流程

1.  若您尚未登入，請登入 `https://make.powerapps.com`

2.  從右上方的 [ **環境]** 功能表單中，確定 **已選取 [開發 One** 環境]。 

3.  使用左側的巡覽功能，選取 [資料表]****。 

4.  開啟上一個練習中建立的 [造訪]**** 資料表。 

5.  使用頂端的功能表，選取 [匯入]**** >  [匯入資料]****。

6.  在 [選擇資料來源]**** 對話方塊中，選取 [Excel 活頁簿]****。

7.  選取 [連結至檔案]**** 選項。 選取**瀏覽 OneDrive**。 若出現提示，請使用您的 Microsoft 365 認證登入。 將瀏覽器設定為一律允許快顯視窗。 

8.  選取在上一個工作中上傳至 OneDrive 的 **Visits.xlsx** 檔案。 

9.  選取 [下一步]****。 

10. 在 [Power query]**** >  [選擇資料] **** 畫面上 ，檢查 [造訪]**** Excel 活頁簿。 

11. 選取 [下一步]****。 請勿離開此頁面的瀏覽。

12. 選取 [下一步]****。 

13. 在 [對應資料表]**** 區段中的 [載入設定]**** 下方，選取 [載入現有資料表中]****。 

14. 在 [目的地資料表]**** 下拉式功能表中，選取 **crXXX_Visit** 資料表 (其中 XXX 為一組隨機字母和數字)

15. 在 [資料行對應] **** 區段上，將資料行對應至其對應的目的地資料行：

    | 目的地資料行  | 來源資料行   |
    |:---------------------|:----------------|
    | crxxx_ActualEnd      | 實際結束時間      |
    | crxxx_ActualStart    | 實際開始時間    |
    | crxxx_Code           | code            |
    | crxxx_Name           | NAME            |
    | crxxx_ScheduledEnd   | 排定結束時間   |
    | crxxx_ScheduledStart | 排定開始時間 |

16. 選取 [下一步]****。 

17. 選取 [手動重新整理]****。 

18. 選取**發行**。 

    > **注意：** 將資料匯入資料表可能需要花費數分鐘的時間。 如果出現一些錯誤，請無需擔心，這是正常的情況且不會影響課程的其餘部分。


## 工作 \#3：確認資料匯入

1.  匯入資料後，請使用畫面左側的瀏覽來選取 [資料表]****，並開啟 [瀏覽]**** 資料表。

2.  確認您在 [Visit columns and data] (造訪資料行和資料)**** 區段下看到匯入的資料。

恭喜，您已順利建立了新資料表並匯入資料。


